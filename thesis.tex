% !TeX spellcheck = <none>
\documentclass{book}

\usepackage[utf8]{inputenc}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{indentfirst}

\usepackage{xparse}

\newtheorem{theorem}{Teoerma}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposizione}
\newtheorem{corollary}[theorem]{Corollario}
\newtheorem{problem}[theorem]{Problema}

\newenvironment{proof}[1][Dimostrazione]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{definition}[1][Definizione]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{example}[1][Esempio]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{remark}[1][Osservazione]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
    \ifdim\lastskip<1.5em \hskip-\lastskip
     \hskip1.5em plus0em minus0.5em \fi \nobreak
     \vrule height0.75em width0.5em depth0.25em\fi}

\newcommand{\bsigma}{\boldsymbol{\sigma}}
\newcommand{\Nabla}{\boldsymbol{\nabla}}
\newcommand{\tc}{\ \text{t.c.}\ }
\DeclareDocumentCommand{\ps}{m m o o}{
\IfNoValueTF{#4}{
  \IfNoValueTF{#3}{ (#1,#2) }{ _{{#3}'}(#1,#2)_{#3} } 
  }{_{#3}(#1,#2)_{#4}}
}
\newcommand{\IB}{\textit{Immersed Boundary}}
\DeclareMathOperator{\volume}{volume}
\DeclareMathOperator{\traccia}{traccia}


\begin{document}

\chapter{Introduzione}

\section{Roba, coordinate euleriane, coordinate lagrangiane}

$$\ps{f}{v}[H][A]$$

\section{Cenni di Fluidodinamica}

%A Mathematical Introduction to Fluid Mechanics, A. Chorin, J. E. Marsden, 1992 Springer-Verlag Publishing Company Inc., terza edizione (forse preprint quarta) Capitolo 1 1-46
La fluidodinamica studia e descrive il movimento dei fluidi. Le equazioni che governano questo movimento sono ricavate a partire dalle leggi di conservazione della massa, del momento e dell'energia. Nel caso di fluidi perfetti si ottengono le equazioni di Eulero, mentre nel caso di fluidi viscosi si ottengono le equazioni di Navier-Stokes.

\subsection{Le equazioni di Eulero}

Sia $\mathcal{D} \subseteq \mathbb{R}^{2,3}$ una porzione di spazio contenente un fluido, $\mathbf{x} \in \mathcal{D}$ un punto del fluido in coordinate euleriane, $\mathbf{u}(\mathbf{x},t)$ la velocità del fluido nel punto $\mathbf{x}$ al tempo $t$. Per ogni tempo $t$, $\mathbf{u}$ è un campo vettoriale su $\mathcal{D}$ ed è detto campo delle velocità del fluido. Sia $\rho(\mathbf{x},t)$ la densità del fluido nel punto $\mathbf{x}$ al tempo $t$.  L'esistenza di $\rho$ è detta ipotesi del continuo ed equivale a considerare il corpo come un oggetto senza soluzione di continuità trascurando la natura molecolare del fluido. Questa ipotesi rimane accettabile fintanto che si studiano i fenomeni macroscopici che avvengono nel fluido. Sia $\mathcal{W} \subseteq \mathcal{D}$ una parte dello spazio occupato dal fluido e $m(\mathcal{W},t)= \int_{\mathcal{W}}\rho(\mathbf{x},t) \, dV$ la massa del fluido contenuto in $\mathcal{W}$ al tempo $t$. Si supponga sempre inoltre che le funzioni usate abbiano sufficiente regolarità per dare senso alle espressioni scritte. 

Le equazioni di Eulero sono ricavate a partire del principio di conservazione della massa (\emph{la massa non si crea e non si distrugge}), del momento (\emph{seconda legge di Newton}) e dell'energia (\emph{l'energia non si crea e non si distrugge}).

\paragraph{La conservazione della massa}
Nell'ipotesi che la massa del fluido si conservi è necessario che le uniche variazioni di massa per ogni porzione di fluido siano dovute al solo fluido che entra o esce dalla data porzione. Sia $\partial \mathcal{W}$ il bordo, supposto liscio, di  $\mathcal{W}$ e $\mathbf{n}(\mathbf{x})$ la normale uscente a $\partial \mathcal{W}$ nel punto $\mathbf{x}$ allora la massa del fluido uscente da $\mathcal{W}$ per unità di area $dA$ per unità di tempo è data da $\rho \mathbf{u}\cdot \mathbf{n}$.
\begin{equation*}  
\begin{split}
\frac{d}{dt} m(\mathcal{W},t) &= \frac{d}{dt}  \int_{\mathcal{W}}\rho(\mathbf{x},t) \, dV \\
                              &= \int_{\mathcal{W}}\frac{\partial}{\partial t}\rho(\mathbf{x},t) \, dV \\
                              &= - \int_{\partial \mathcal{W}}\rho(\mathbf{x},t) \mathbf{u}(\mathbf{x},t) \cdot \mathbf{n}(\mathbf{x}) \, dV
\end{split}
\end{equation*}
che grazie al teorema della divergenza diventa
\begin{equation*}
\int_{\mathcal{W}}\frac{\partial}{\partial t}\rho(\mathbf{x},t) \, dV = -\int_{\mathcal{W}}\Nabla \cdot \left (\rho(\mathbf{x},t) \mathbf{u}(\mathbf{x},t) \right ) \, dV
\end{equation*}
e quindi
\begin{equation}\label{eq:conservazione massa integrale}
\boxed{
\int_{\mathcal{W}}\left [ \frac{\partial}{\partial t}\rho(\mathbf{x},t) + \Nabla \cdot (\rho(\mathbf{x},t) \mathbf{u}(\mathbf{x},t)) \right ]\, dV = 0
}
\end{equation}
L'equazione \ref{eq:conservazione massa integrale} è detta legge della conservazione della massa in forma integrale.

Dovendo essere vera per ogni $\mathcal{W}$ l'equazione \ref{eq:conservazione massa integrale} è equivalente a 
\begin{equation}\label{eq:conservazione massa differenziale}
\boxed{
\frac{\partial \rho}{\partial t} + \Nabla \cdot (\rho \mathbf{u}) = 0
}
\end{equation}
Questa è la forma differenziale della legge di conservazione della massa, altrimenti detta equazione di continuità.

\paragraph{La conservazione del momento}
Sia $\mathbf{x}(t) = (x(t),y(t),z(t))$ la traiettoria seguita da una particella del fluido e $\mathbf{u}(t) = (\dot{x}(t),\dot{y}(t),\dot{z}(t)) = \mathbf{u}(\mathbf{x}(t)) = \frac{d\mathbf{x}}{dt}(t)$ la sua velocità allora l'accelerazione della particella sarà data da
\begin{equation*} 
\mathbf{a}(\mathbf{x}(t)) = \frac{d^2\mathbf{x}}{dt^2} (t) = \frac{\partial  \mathbf{u}}{\partial x}\dot{x} + \frac{\partial  \mathbf{u}}{\partial y}\dot{y} + \frac{\partial  \mathbf{u}}{\partial z}\dot{z} + \frac{\partial \mathbf{u}}{\partial t}
= \nabla  \mathbf{u} \cdot  \mathbf{u} + \frac{\partial \mathbf{u}}{\partial t} = \frac{D \mathbf{u}}{Dt}
\end{equation*}
dove $\frac{D}{Dt}=\partial_t + \mathbf{u}\cdot\Nabla$ è detta derivata materiale [...].
Lo stesso ragionamento è applicabile a ogni funzione $f=f(x(t),y(t),z(t),t)$ scalare o vettoriale
\begin{equation*}
\frac{df}{dt}=\partial_tf+\mathbf{u}\cdot\Nabla f = \frac{Df}{Dt}
\end{equation*}

Le forze che agiscono su di un corpo continuo possono essere di due soli tipi: le forze di stress e le forze esterne o esogene. Le forze di stress sono le forze applicate su una superficie interna al corpo dal resto del corpo. Le forze esterne sono invece forze applicate per unità di volume da agenti esterni al corpo[...]. Un fluido si dice ideale se esiste una funzione $p(\mathbf{x},t)$ detta pressione per cui le forze di stress sono del tipo $\mathbf{F}\,dA = p(\mathbf{x},t)\mathbf{n}$ cioè sono forze normali alla superficie. In particolare l'assenza di componenti tangenziali delle forze di stress impedisce l'instaurarsi o il cessare di movimenti rotatori nel fluido.

Presa $\mathcal{W}$ una regione del fluido la forza di stress applicata dal resto del corpo è
$$\mathbf{S}_{\partial\mathcal{W}} = - \int_{\partial\mathcal{W}} p\mathbf{n}\,dA$$.
Scelta una direzione $\mathbf{e}$ applicando il teorema della divergenza
$$\mathbf{e}\cdot\mathbf{S}_{\partial\mathcal{W}} = - \int_{\partial\mathcal{W}} p\mathbf{e}\cdot\mathbf{n}\,dA
                                                  = - \int_{\mathcal{W}} \nabla p \cdot \mathbf{e} \, dV $$
e quindi
$$\mathbf{S}_{\partial\mathcal{W}} = - \int_{\mathcal{W}} \nabla p \, dV $$

Usando la seconda legge di Newton e aggiungendo il termine relativo alle forze esterne si ottiene 
\begin{equation}\label{eq:conservazione momento differenziale}
\boxed{
\rho \frac{\partial \mathbf{u}}{\partial t} = - \rho \mathbf{u} \cdot \nabla \mathbf{u} - \nabla p + \rho \mathbf{b}
}
\end{equation}
che è la legge di conservazione del momento in forma differenziale.

La forma integrale della legge di conservazione del momento può essere ricavata direttamente dalla forma differenziale[...]
\begin{equation}
\boxed{
\frac{d}{dt}\int_{\mathcal{W}}\rho \mathbf{u} = - \int_{\partial\mathcal{W}}(p\mathbf{n}+\rho\mathbf{u}(\mathbf{u} \cdot \mathbf{n})) \, dA + \int_{\mathcal{W}}\rho\mathbf{b}\, dV
}  
\end{equation}

E' possibile ricavare la forma integrale della legge di conservazione del momento senza passare dalla forma differenziale.
Sia $\phi(\mathbf{x},t)$ la traiettoria seguita dal punto materiale che si trova in posizione $\mathbf{x}$ al tempo $t=0$. Si ipotizzi che $\phi$ sia regolare e invertibile per $t$ fissato. Sia $\phi_t:\mathbf{x}\mapsto\phi (\mathbf{x},t)$ la mappa che associa ad ogni punto la posizione che avrà al tempo $t$. $\phi$ è detta mappa del flusso del fluido. Indichiamo con $\mathcal{W}_t = \phi_t(\mathcal{W})$ il volume $\mathcal{W}$ trasportato dal fluido.

La legge di conservazione del momento si scrive quindi come
\begin{equation}\label{eq:conservazione momento integrale}
\frac{d}{dt} \int_{\mathcal{W}_t} \rho \mathbf{u} \, dV = S_{\partial \mathcal{W}_t} +  \int_{\mathcal{W}_t} \rho \mathbf{b} \, dV
\end{equation}


Questa è equivalente alla forma differenziale se le funzioni sono sufficientemente regolari.

Compiendo un cambio di variabile nell'integrale
$$\frac{d}{dt} \int_{\mathcal{W}_t} \rho \mathbf{u} \, dV = \frac{d}{dt} \int_{\mathcal{W}} (\rho \mathbf{u})(\phi(\mathbf{x},t),t) J(\mathbf{x},t) \, dV$$
dove $J(\mathbf{x},t)$ è il determinante della matrice jacobiana di $\phi_t$.

Differenziando ora sotto il segno di integrale nel secondo membro
\begin{equation*}  
\begin{split}
\frac{d}{dt} \int_{\mathcal{W}_t} \rho \mathbf{u} \, dV &= \int_{\mathcal{W}} \frac{\partial}{\partial t}[ (\rho \mathbf{u})(\phi(\mathbf{x},t),t) J(\mathbf{x},t) ]\, dV \\
&= \int_{\mathcal{W}} \left[\frac{\partial}{\partial t} (\rho \mathbf{u})(\phi(\mathbf{x},t),t) J(\mathbf{x},t) + (\rho \mathbf{u})(\phi(\mathbf{x},t),t) \frac{\partial}{\partial t}  J(\mathbf{x},t)\right] \, dV
\end{split}
\end{equation*}

Si osservi che $$\frac{\partial}{\partial t} (\rho \mathbf{u})(\phi(\mathbf{x},t),t) = \left(\frac{D}{D t} \rho \mathbf{u}\right)(\phi(\mathbf{x},t),t) $$.

Enunciamo ora il seguente lemma
\begin{lemma}\label{lemma:incomprimibile}
$\frac{\partial}{\partial t}  J(\mathbf{x},t) = J(\mathbf{x},t) \Nabla \cdot \mathbf{u} (\phi(\mathbf{x},t),t)$  
\end{lemma}
\begin{proof}
[...]
\end{proof}

Applicando il lemma si ottiene
\begin{equation*}
\begin{split}
\frac{d}{dt}\int_{\mathcal{W}_t}\rho\mathbf{u}\, dV &= \int_{\mathcal{W}} \left \{ \left ( \frac{D}{Dt}\rho\mathbf{u} \right )(\phi(\mathbf{x},t),t)+(\rho\mathbf{u})(\Nabla\cdot\mathbf{u})(\phi(\mathbf{x},t),t) \right \} J(\mathbf{x},t)\, dV\\
&=\int_{\mathcal{W}_t}\left \{ \frac{D}{Dt}(\rho\mathbf{u})+(\rho\Nabla\cdot\mathbf{u})\mathbf{u}\right \}\,dV
\end{split}
\end{equation*}
Usando ora l'equazione \ref{eq:conservazione massa differenziale}
$$\frac{D}{Dt}\rho+\rho\Nabla\cdot\mathbf{u}=\frac{\partial\rho}{\partial t}+\Nabla\cdot(\rho\mathbf{u})$$
e quindi
$$\frac{d}{dt}\int_{\mathcal{W}_t}\rho\mathbf{u}\, dV = \int_{\mathcal{W}_t}\rho\frac{D\mathbf{u}}{Dt}\, dV$$.

Questo ragionamento è in realtà valido per ogni funzione e prende il nome di teorema del trasporto.
\begin{theorem}{Teorema del trasporto}
$$ \forall f:\mathbb{R}^3\times[0,T]\mapsto M $$ $$\frac{d}{dt}\int_{\mathcal{W}_t}\rho f\, dV = \int_{\mathcal{W}_t}\rho\frac{Df}{Dt}\,dV$$
\end{theorem}

Essendo le funzioni continue e $\mathcal{W}$ qualunque allora \ref{eq:conservazione momento integrale} è equivalente a \ref{eq:conservazione momento differenziale}.

Sfruttando il lemma \ref{lemma:incomprimibile}possiamo caratterizzare i fluidi incomprimibili infatti
$$\volume(\mathcal{W}_t) = \int_{\mathcal{W}_t} \, dV$$
quindi per un fluido incomprimibile
$$0 = \frac{d}{dt} \int_{\mathcal{W}_t} \, dV  = \int_{\mathcal{W}_t} \Nabla \cdot \mathbf{u} \, dV$$
Quindi un fluido è incomprimibile se e solo se $\Nabla \cdot \mathbf{u}=0$ ( o anche se e solo se $J \equiv 1$ ).
$$0 = \frac{\partial \rho}{\partial t} + \Nabla\cdot(\rho \mathbf{u}) = \frac{D\rho}{Dt} + \rho\Nabla\cdot \mathbf{u}$$
quindi un fluido è incomprimibile se e solo se $\frac{D \rho}{Dt} = 0$ cioè se e solo se la densità del fluido è costante seguendo il flusso.
Un fluido si dice omogeneo se $\rho(\mathbf{x},t)=C_t \quad \forall \mathbf{x}$, è anche incomprimibile se $C_t=C \quad \forall t$

Diamo ora un'altra caratterizzazione della legge di conservazione della massa sfruttando il teorema del trasporto.
$$\frac{d}{dt}\int_{\mathcal{W}_t}\rho\,dV=0$$
e quindi
$$\int_{\mathcal{W}_t}\rho(\mathbf{x},t)\,dV=\int_\mathcal{W}\rho(\mathbf{x},0)\,dV$$
Effettuando un cambio di variabile
$$\int_{\mathcal{W}}\rho(\phi(\mathbf{x},t),t)J(\mathbf{x},t)\,dV=\int_\mathcal{W}\rho(\mathbf{x},0)\,dV$$
e quindi
\begin{equation}
  \boxed{
  \rho(\phi(\mathbf{x},t),t)J(\mathbf{x},t)=\rho(\mathbf{x},0)\,dV
  }
\end{equation}
In particolare si nota che un fluido omogeneo ma non incomprimibile non rimane omogeneo col passare del tempo.

\paragraph{La conservazione dell'energia}
Sia $$E_{\text{kinetic}} = \frac{1}{2} \int_{\mathcal{W}} \rho \Vert \mathbf{u} \Vert^2 \, dV$$ l'energia cinetica del fluido contenuto in $\mathcal{W}$, $E_{\text{internal}}$ l'energia interna dovuta a fenomeni microscopici tra le molecole del fluido e $$E_{\text{total}}=E_{\text{kinetic}}+E_{\text{internal}}$$ l'energia totale.
La variazione dell'energia cinetica nella porzione di fluido in movimento $\mathcal{W}_t$ calcolata grazie al teorema del trasporto è 
\begin{equation}
\begin{split}
\frac{d}{dt} E_{\text{kinetic}} &= \frac{d}{dt} \frac{1}{2} \int_{\mathcal{W}} \rho \Vert \mathbf{u} \Vert^2 \, dV \\
                                &= \frac{1}{2}  \int_{\mathcal{W}_t} \rho \frac{D\Vert \mathbf{u} \Vert^2}{Dt} \, dV \\
                                &=  \int_{\mathcal{W}_t} \rho ( \mathbf{u} \cdot ( \frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} )) \, dV
\end{split}
\end{equation}
[...]

Consideriamo ora il caso in cui il fluido sia incomprimibile e che tutta l'energia del fluido sia nella forma di energia cinetica (oppure è sufficiente che l'energia interna sia costante). Allora la variazione dell'energia cinetica è dovuta al lavoro compiuto dalla pressione e dalle forze esterne

$$\frac{d}{dt} E_{\text{kinetic}} = - \int_{\partial \mathcal{W}_t} p \mathbf{u} \cdot \mathbf{n} \, dA + \int_{\mathcal{W}_t} \rho \mathbf{u} \cdot \mathbf{b} \, dV $$

e quindi usando il teorema della divergenza e tenendo conto che $\nabla \cdot \mathbf{u} = 0$

\begin{equation}
\begin{split}
\int_{\mathcal{W}_t} \rho \left ( \mathbf{u} \cdot \left ( \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \Nabla \mathbf{u} \right )\right ) \, dV
 &= - \int_{\mathcal{W}_t} ( \Nabla \cdot (p\mathbf{u}) - \rho \mathbf{u} \cdot \mathbf{b}) \, dV \\
 &=  - \int_{\mathcal{W}_t} ( \nabla p  \cdot \mathbf{u}) - \rho \mathbf{u} \cdot \mathbf{b}) \, dV
\end{split}
\end{equation}
Osserviamo che se varia solo l'energia cinetica allora il fluido è incomprimibile [oppure $p=0$, fluido fermo].
 
Si ottengono cosi le equazioni di Eulero per i fluidi incomprimibili
\begin{equation}
\boxed{
\begin{aligned}
\rho \frac{D\mathbf{u}}{Dt} &= - \nabla p + \rho \mathbf{b} \\
\frac{D \rho }{Dt} &= 0 \\
\nabla \cdot \mathbf{u} &= 0
\end{aligned}
}
\end{equation}
a cui va aggiunta la condizione al bordo 
$$\mathbf{u} \cdot \mathbf{n} = 0 \quad \text{su} \quad \partial \mathcal{D}$$
 
[FLUIDI ISENTROPICI?]
Consideriamo il caso ora di un fluido isoentropico ovvero in cui esiste una funzione $w$ chiamata entalpia per cui
$\nabla w = \frac{1}{\rho} \nabla p$
[parentesi termodinamica]
La maggior parte dei gas reali può essere considerata come un fluido isoentropico in cui $p = A \rho ^ \gamma$ con $A$ e $\gamma \geq 1$ costanti.
 
\subsection{Rotazioni e vorticità}

Sia $\mathbf{u} = (u,v,w)$ il campo delle velocità di un fluido allora il suo rotore 
$$\boldsymbol{\xi} = \nabla \times \mathbf{u} = (\partial_y w - \partial_z v, \partial_z u - \partial_x w, \partial_x v - \partial_y u)$$
è detto campo della vorticità del fluido.

Si può dimostrare che $\mathbf{u}$ è localmente la somma di una traslazione rigida, di una deformazione e di una rotazione rigida di vettore $\frac{\boldsymbol{\xi}}{2}$. Cominciamo enunciando il seguente teorema che vale per ogni campo vettoriale definito su $\mathbb{R}^3$.

\begin{theorem}
Sia $\mathbf{x} \in \mathbb{R}^3$ e $\mathbf{y} = \mathbf{x} + \mathbf{h}$ un punto vicino. Allora 
\begin{equation}\label{eq:helmoltz}
\mathbf{u}(\mathbf{y}) = \mathbf{u}(\mathbf{x}) + \mathbf{D}(\mathbf{x}) \cdot \mathbf{h} + \frac{1}{2} \boldsymbol{\xi}(\mathbf{x}) \times \mathbf{h} + \mathcal{O} ( h^2)
\end{equation}
con $\mathbf{D}$ matrice simmetrica.
\end{theorem}
\begin{proof}
Sia
\begin{equation}
\Nabla\mathbf{u}={\setlength\arraycolsep{2pt} 
\left(\begin{array}{ccc} 
\partial_x u&  \partial_y u &\partial_z u\\ 
\partial_x v&  \partial_y v &\partial_z v\\ 
\partial_x w&  \partial_y w &\partial_z w\\
\end{array}\right) 
}
\end{equation}
la matrice jacobiana di $\mathbf{u}$.
Per il teorema di Taylor
$$\mathbf{u}(\mathbf{y}) = \mathbf{u}(\mathbf{x}) + \Nabla\mathbf{u}(\mathbf{x}) \cdot \mathbf{h} + \mathcal{O} ( h^2)$$
Siano rispettivamente
$$\mathbf{D} = \frac{1}{2} [ \Nabla\mathbf{u} + \Nabla\mathbf{u} ^T]$$
la parte simmetrica e
$$\mathbf{S} = \frac{1}{2} [ \Nabla\mathbf{u} - \Nabla\mathbf{u} ^T]$$
la parte antisimmetrica di $ \Nabla\mathbf{u}$.
\`E immediato verificare che
\begin{equation}
\mathbf{S}=\frac{1}{2}{\setlength\arraycolsep{2pt} 
\left(\begin{array}{ccc} 
0&  -\xi_3 &\xi_2\\ 
\xi_2&  0 &-\xi_1\\ 
-\xi_2&  \xi_1 &0\\
\end{array}\right) 
}
\end{equation}
e quindi
$$\mathbf{S} \cdot \mathbf{h} = \frac{1}{2} \boldsymbol{\xi} \times \mathbf{h}$$.
\qed%è bruttissimo XD
\end{proof}

La matrice $\mathbf{D}$ è detta tensore della deformazione. Dato che $\mathbf{D}$ simmetrica esiste una base ortonormale in cui è diagonale
\begin{equation}
\mathbf{D}={\setlength\arraycolsep{2pt} 
\left(\begin{array}{ccc} 
d_1 & 0 & 0 \\ 
0 & d_2 & 0 \\ 
0 & 0 & d_3 \\
\end{array}\right) 
}
\end{equation}.
Considerando solo il contributo di questo termine l'equazione \ref{eq:helmoltz} diventa 
$$\frac{d h_i}{dt} = d_i h_i$$
Si tratta quindi di una contrazione o espansione nelle direzione della base ortonormale trovata.

Inoltre è possibile calcolare la variazione di volume
\begin{equation}
\begin{split}
\frac{d}{dt}h_1 h_2 h_3 &= \left [ \frac{dh_1}{dt} \right ] h_2h_3 + \left [ \frac{dh_2}{dt} \right ] h_1h_3 + \left [ \frac{dh_3}{dt} \right ] h_1h_2 \\
                                        &= \traccia \mathbf{D} h_1 h_2 h_3  \\
                                        &= \traccia  \frac{1}{2} [ \Nabla\mathbf{u} + \Nabla\mathbf{u} ^T] h_1 h_2 h_3 \\ 
                                        &= \Nabla \cdot \mathbf{u} h_1 h_2 h_3
\end{split}
\end{equation}
perché la traccia è invariante rispetto a cambi di coordinate. Si riottiene quindi che la deformazione è proporzionale a $ \Nabla \cdot \mathbf{u}$.

Il termine $\mathbf{u}(\mathbf{x})$ è una traslazione.

Il termine $\frac{1}{2}\boldsymbol{\xi}(\mathbf{x})\times\mathbf{h}$, usando lo stesso ragionamento usato nel caso di $\mathbf{D}$
$$\frac{d\mathbf{h}}{dt}=\frac{1}{2}\boldsymbol{\xi}(\mathbf{x})\times\mathbf{h}$$
la cui soluzione è
$$\mathbf{h}(t)=\mathbf{R}(t,\boldsymbol{\xi}(\mathbf{x}))\mathbf{h}(0)$$
con $\mathbf{R}$ rotazione rigida di angolo $t$ e asse $\boldsymbol{\xi}$. 

Le ipotesi fatte fino ad ora impediscono il presentarsi di qualsiasi forza tangenziale e quindi di qualsiasi meccanismo che possa causare o fermare una rotazione del fluido, cioè in ogni movimento del fluido la rotazione viene conservata. Data la stretta connessione tra rotazione e vorticità ci si aspetta che la vorticità sia connessa a questo fatto. 

[...][circolazioni,teorema di helmotz, teorema di kelvin]

\subsection{L'equazione di Navier Stokes}
Nei fluidi reali la quantità di moto viene diffusa anche grazie ai movimenti molecolari.
Rinunciamo ora all'ipotesi che il fluido sia ideale, e quindi ammettiamo anche forze di stress non in direzione normale.
Il teorema di Cauchy ci garantisce che la forza che agisce su $S$ è una 
$$F \, dA = -p(\mathbf{x},t) \mathbf{n} + \boldsymbol{\sigma}(\mathbf{x},t) \cdot \mathbf{n}$$
dove $\boldsymbol{\sigma}$ è il tensore degli stress.
Con questa nuova forza la legge di conservazione del momento diventa
$$\frac{d}{dt} \int_{\mathcal{W}_t} \rho \mathbf{u} \, dV = \int_{\partial \mathcal{W}_t} (p \mathbf{n} - \boldsymbol{\sigma} \cdot \mathbf{n} )\, dA$$
Faremo inoltre le seguenti ipotesi su $\boldsymbol{\sigma}$: \begin{itemize}
  \item $\boldsymbol{\sigma}$ dipende linearmente dal gradiente della velocità $\Nabla \mathbf{u}$;
  \item $\boldsymbol{\sigma}$ è invariante rispetto a rotazioni rigide, cioè data $\mathbf{U}$ matrice ortogonale
$$\boldsymbol{\sigma}(\mathbf{U} \cdot \Nabla \mathbf{u} \cdot \mathbf{U}^{-1}) = \mathbf{U} \cdot \boldsymbol{\sigma}( \Nabla \mathbf{u} ) \cdot \mathbf{U}^{-1}$$
\item $\boldsymbol{\sigma}$ è simmetrico.
\end{itemize} 

Dato che $\boldsymbol{\sigma}$ è simmetrico dipenderà solo dalla parte simmetrica di $\Nabla \mathbf{u}$, cioè dalla deformazione $\mathbf{D}$. Inoltre $\boldsymbol{\sigma}$ e $\mathbf{D}$ possono essere diagonalizzate simultaneamente in quanto commutano essendo $\boldsymbol{\sigma}$ una funzione lineare di $\mathbf{D}$.
Quindi gli autovalori di sigma sono funzioni lineari e simmetriche di quelli di D.
$$\sigma_i = \lambda (d_1 + d_2 + d_3) +2 \mu d_i$$
e quindi 
$$\boldsymbol{\sigma} = \lambda ( \Nabla\cdot \mathbf{u}) \mathbf{I} + 2 \mu \mathbf{D}
                                     = 2 \mu [ \mathbf{D} - \frac{1}{3} ( \Nabla\cdot \mathbf{u}) \mathbf{I} ] + \zeta ( \Nabla\cdot \mathbf{u})  \mathbf{I}
$$
$\mu$ è il primo coefficiente di viscosità e $\zeta$ è il secondo coefficiente di viscosità.

Usando il teorema del trasporto ora si ottiene l'equazione di Navier-Stokes

$$\rho \frac{D\mathbf{u}}{Dt} = -\nabla p + (\lambda+\mu) \nabla(\Nabla \cdot \mathbf{u}) + \mu \boldsymbol{\Delta} \mathbf{u}$$

Nel caso di fluidi incomprimibili le equazioni diventano
\begin{equation}
\boxed{
\begin{aligned}
\frac{D\mathbf{u}}{Dt} &= - \nabla p + \nu \boldsymbol{\Delta} \mathbf{u} \\
\Nabla \cdot  \mathbf{u} &= 0 \\
\mathbf{u} &= 0 \quad \text{su} \quad \partial \mathcal{D}
\end{aligned}
}
\end{equation}
L'ultima equazione è la cosiddetta condizione \emph{no-slip}, per cui il fluido è a riposo sulle pareti.

Nel caso dei fluidi incomprimibili quindi il tensore di stress $\boldsymbol{\sigma}$ dipende dal moltiplicatore di Lagrange relativo al vincolo di incomprimibilità $p$, anche detto pressione idrostatica, e dalla parte simmetrica di $\Nabla\mathbf{u}$, $\mathbf{D}=\frac{1}{2}(\Nabla\mathbf{u}+(\Nabla\mathbf{u})^{T})$
$$\boldsymbol{\sigma}=-p\mathbf{I}+\eta(\Nabla\mathbf{u}+(\Nabla\mathbf{u})^{T})$$
la cui divergenza è
$$\Nabla\cdot\boldsymbol{\sigma}=-\nabla p+\eta\Delta\mathbf{u}$$.
[numero di Reynolds][metodi di proiezione per la pressione e equazione di Stokes]

\subsection{Le equazioni della fluidodinamica in forma debole}
%The Finite Element Immersed Boundary Method, L. Heltai ,Ph.D. Thesis , 2006, capitolo 1 19-35
Scriviamo ora l'equazione di Navier-Stokes in forma variazionale.

Sia
$$V = H^1_0(\Omega)^d = \bigg \{ \mathbf{v} \in L^2(\Omega)^d \quad \tc \quad \Nabla \mathbf{v} \in L^2(\Omega)^{d \times d} \quad \text{e} \quad \mathbf{v}\mid_{\partial \Omega} = 0 \bigg \} $$
lo spazio delle velocità e 
$$Q = L^2_0(\Omega) = \left  \{ q \in L^2(\Omega) \quad \tc \quad \int_{\Omega}q=0 \right  \}$$ lo spazio delle pressioni. Indichiamo con $V'$ lo spazio duale di $V$.

Dati $b \in V'$ e $\mathbf{u}_0 \in V$, per ogni $t \in ]0,T[$ trovare $(\mathbf{u},p) \in V \times Q$ tale che
\begin{multline*}
\rho \left ( \frac{d}{dt}\ps{\mathbf{u}(t)}{\mathbf{v}} + \ps{\mathbf{u}(t)\cdot \Nabla\mathbf{u}(t)}{\mathbf{v})}\right)+ \nu\ps{\Nabla\mathbf{u}(t)}{\Nabla\mathbf{v}}-\ps{\Nabla \mathbf{v}}{p(t)}=\ps{\mathbf{b}}{\mathbf{v}}
\end{multline*}
$$\ps{\Nabla\cdot\mathbf{u}(t)}{q}=0$$
$$\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x})$$

Definendo i seguenti operatori associati ai termini dell'equazione di Navier-Stokes
\begin{equation}
\begin{aligned}
(M\mathbf{u})(\mathbf{v})&=\rho\ps{\mathbf{u}}{\mathbf{v}} \quad &\mathbf{u},\mathbf{v}\in \mathbf{V}\\
(A\mathbf{u})(\mathbf{v})&=a(\mathbf{u},\mathbf{v})=\eta\ps{\Nabla\mathbf{u}}{\Nabla\mathbf{v}} \quad &\mathbf{u},\mathbf{v}\in \mathbf{V}\\
(N(\mathbf{w})\mathbf{u})(\mathbf{v})&=c(\mathbf{w},\mathbf{u},\mathbf{v})=\rho\ps{\mathbf{w}\cdot\Nabla\mathbf{u}}{\Nabla\mathbf{v}} \quad &\mathbf{w},\mathbf{u},\mathbf{v}\in \mathbf{V}\\
(B\mathbf{u})(q)&=b(\mathbf{u},q)=\ps{\Nabla\cdot\mathbf{u}}{q} \quad &\mathbf{u}\in \mathbf{V},q\in Q
\end{aligned}
\end{equation}
possiamo riscrivere le equazioni come
\begin{equation}
\begin{aligned}
&\rho\frac{d}{dt}\ps{\mathbf{u}}{\mathbf{v}}+a(\mathbf{u},\mathbf{v})+c(\mathbf{w},\mathbf{u},\mathbf{v})+b(\mathbf{v},p)=\ps{\mathbf{b}}{\mathbf{u}} \quad &\forall\mathbf{v}\in\mathbf{V}\\
&b(\mathbf{u},q)=0 \quad &\forall q\in Q\\
&\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x})&
\end{aligned}
\end{equation}
oppure in termini di operatori degli spazi duali
\begin{equation}
\begin{aligned}
&M\frac{\partial\mathbf{u}}{\partial t}+A\mathbf{u}+N(\mathbf{u})\mathbf{u}+B^{T}p=\mathbf{b}\\
&B\mathbf{u}=0\\
&\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x})&
\end{aligned}
\end{equation}
[vedi 31,32,33,34]

\paragraph{Stima dell'energia}
\begin{theorem}
Per ogni $t \in ]0,T[$ sia $(\mathbf{u}(t),p(t)) \in V \times Q$ la soluzione del problema con $\mathbf{b}=0$, allora
$$\rho \frac{1}{2} \frac{d}{dt} \Vert \mathbf{u} (t) \Vert^2_{0,\Omega} + \eta \Vert \Nabla \mathbf{u} (t) \Vert^2_{0,\Omega} = 0$$
\end{theorem}
\begin{proof}
Per dimostrarlo si prendano $\mathbf{v}=\mathbf{u}$ e $q=p$ come funzioni di test nelle equazioni. Allora $b(\mathbf{u},p=0)$ e $c(\mathbf{u},\mathbf{u},\mathbf{u})=0$.
\end{proof}
Il teorema afferma che la variazione di energia cinetica è pari all'energia dissipata dai fenomeni viscosi.
I fluidi governati dalle equazioni di Navier-Stokes incomprimibili non possono accumulare energia se non sottoforma di energia cinetica dato che il fluido è incomprimibile e lo stress $\boldsymbol{\sigma}$ non dipende dalla deformazione del fluido. 

\section{Teoria matematica dell'elasticità}
%Mersden Mathematical Foundation of Elasticity
Sia $\mathcal{B} \in \mathbb{R}^3$ la chiusura di un aperto con bordo a tratti liscio. $\mathcal{B}$ è detta configurazione di riferimento del corpo in esame.
Una configurazione o deformazione di $\mathcal{B}$ è una mappa $\phi: \mathcal{B} \to \mathbb{R}^3$ sufficientemente liscia, che preserva l'orientamento e invertibile. I punti $\mathbf{X}=(X_1,X_2,X_3) \in \mathcal{B}$ sono detti punti materiali, mentre i punti $\mathbf{x}=(x_1,x_2,x_3) \in \mathbb{R}^3$ sono detti punti spaziali. 
Un moto di $\mathcal{B}$ è una famiglia di configurazioni dipendente dal tempo $\phi: \mathcal{B} \times [-T,T] \to R^3$.
La velocità del punto materiale $\mathbf{X}$ è data da 
$$\mathbf{V}(\mathbf{X},t) = \frac{\partial \phi}{\partial t}(\mathbf{X},t)$$,
mentre la velocità del punto spaziale $\mathbf{x}=\phi(\mathbf{X})$ è data da
$$\mathbf{v}(\mathbf{x},t) = \mathbf{V}(\mathbf{X},t)$$.
L'accelerazione è data da
$$\mathbf{A}(\mathbf{X},t) = \frac{\partial^2 \phi}{\partial t^2} = \frac{\partial \mathbf{V}}{\partial t} = \frac{\partial \mathbf{v}}{\partial t}+\mathbf{v}\cdot\Nabla\mathbf{v}$$.
Più in generale [...].
\paragraph{Gradiente di deformazione}
La matrice delle derivate parziali di $\boldsymbol{\phi}$ 
$$ \mathbf{F} = D\boldsymbol{\phi}$$
è detta gradiente di deformazione.
$\boldsymbol{\phi}$ preserva l'orientazione quindi $\mathbf{F} > 0$. 

$\mathbf{F}$ può essere decomposto in maniera univoca come 
$$\mathbf{F}=\mathbf{R}\mathbf{U}=\mathbf{V}\mathbf{R}$$
dove $\mathbf{R}$ è una matrice ortogonale, e quindi rappresenta una rotazione, mentre $\mathbf{U}$ e $\mathbf{V}$ sono matrici simmetriche definite positive e sono dette rispettivamente tensore di stress destro e sinistro. 
Inoltre $\mathbf{U}=\sqrt{\mathbf{F}^T\mathbf{F}}$ e $\mathbf{V}=\sqrt{\mathbf{F}\mathbf{F}^T}$.
Siano $\mathbf{C}=\mathbf{F}^T\mathbf{F}=\mathbf{U}^2$ il tensore destro di Cauchy-Green e $\mathbf{b}=\mathbf{F}\mathbf{F}^T=\mathbf{V}^2$ il tensore sinistro di Cauchy-Green.
Dato che $\mathbf{U}$ e $\mathbf{V}$ sono simili, simmetriche e definite positive allora hanno gli stessi autovalori $\lambda_1$, $\lambda_2$ e $\lambda_3$ reali e positivi, detti tensioni principali. I rispettivi autovettori sono detti direzioni principali. Il valore di $\lambda_i$ rappresenta lo stiramento nella direzione del rispettivo autovettore.
\paragraph{Leggi di Conservazione}
\subparagraph{Conservazione della Massa}
Sia $\boldsymbol{\phi}(\mathbf{x},t)$ un moto di $\mathcal{B}$ e $\rho(\mathbf{x},t)$ la densità di massa del corpo deformato e $\rho_{\mathcal{B}}(\mathbf{X})$ la densità di massa del corpo non deformato. 
Sia $\mathcal{U}\in\mathcal{B}$ una porzione del corpo $\mathcal{B}$ e  $\mathcal{U}_t=\boldsymbol{\phi}(\mathcal{U},t)$ la stessa porzione al tempo $t$. Allora 
$$\int_{\mathcal{U}}\rho_{\mathcal{B}}(\mathbf{X})\, d\mathbf{X} = \int_{\mathcal{U}_t}\rho(\mathbf{x},t)\, d\mathbf{x} = $$
[...] e quindi
$$\int_{\mathcal{U}_t}\frac{\partial\rho}{\partial t}(\mathbf{x},t)\, d\mathbf{x} =  -\int_{\partial\mathcal{U}_t} \mathbf{J} \cdot \mathbf{n} \, da$$
\subparagraph{Conservazione del Momento}
Sia $\mathbf{b}(\mathbf{x},t)$ la forza applicata al corpo $\mathcal{B}$ per unità di massa, e sia $\boldsymbol{\tau}(\mathbf{x},t)$ la forza di superficie applicata per unità di superficie. La coppia $(\mathbf{b},\boldsymbol{\tau})$ è detto carico applicato al corpo. Sia $\mathbf{t}(\mathbf{x},t,\mathbf{n})$ la forza di stress interna al corpo per unità di area nella direzione $\mathbf{n}$. La seconda legge di Newton diventa quindi
$$\frac{d}{dt}\int_{\mathcal{U}_t}\rho\mathbf{v}\, d\mathbf{x} = \int_{\partial \mathcal{U}_t}\mathbf{t}\, da + \int_{\mathcal{U}_t}\rho\mathbf{b}\, d\mathbf{x} $$.
Per il teoreme di Cauchy se vale la legge di conservazione del momento allora $\mathbf{t}$ dipende linearmente da  $\mathbf{n}$, e quindi esiste un tensore $\boldsymbol{\sigma}$ tale che 
$$\mathbf{t}(\mathbf{x},t,\mathbf{n})= \boldsymbol{\sigma}(\mathbf{x},t)\mathbf{n}$$. Questo tensore è detto tensore degli stress di Cauchy. Sfruttando il teorema della divergenza di ottiene
$$\frac{d}{dt}\int_{\mathcal{U}_t}\rho\mathbf{v}\, d\mathbf{x} = \int_{\mathcal{U}_t}\Nabla\cdot\boldsymbol{\sigma}+\rho\mathbf{b}\, d\mathbf{x} $$.
Data l'arbitrarietà di ${\mathcal{U}_t}$ si ottiene l'equazione del moto di Cauchy
$$\rho\frac{d\mathbf{v}}{dt}=\Nabla\cdot\boldsymbol{\sigma}+\rho\mathbf{b}$$. 
\subparagraph{In coordinate lagrangiane}
\'E possibile esprimere il tensore di Cauchy in coordinate lagrangiane sfruttando le quantità materiali al posto di quelle spaziali.
Il primo vettore di stress di Piola-Kirchhoff $\mathbf{T}(\mathbf{X},t,\mathbf{n})$ è un vettore parallelo al vettore di stress di Cauchy $\mathbf{t}(\mathbf{x},t,\mathbf{n})$, ma misura la forza per unità di area non deformata.
[...]
Sia $\mathbf{P}=J\boldsymbol{\sigma}\mathbf{F}^{-T}$ il primo tensore di Piola-Kirchhoff allora
$$\frac{d}{dt}\int_{\mathcal{U}}\rho_{\mathcal{B}}\mathbf{V}\, d\mathbf{X} = \int_\mathcal{U}\Nabla\cdot\mathbf{P}+\rho_{\mathcal{B}}\mathbf{B}\, d\mathbf{X} $$.
Sia $\mathbf{S}=\mathbf{F}^{-1}\mathbf{P}$ il secondo tensore di Piola-Kirchhoff.

\paragraph{Materiali elastici}
Per risolvere le equazioni del moto bisogna determinare come la forza nella seconda equazione di Newton dipende dalla posizione e dalla velocità e come lo stress dipende dal moto nell'equazione del moto di Cauchy. 
Un materiale è elastico se esiste una funzione detta funzione costitutiva $\hat{\mathbf{P}}$ tale che
$$\mathbf{P}(\mathbf{X},t)=\hat{\mathbf{P}}(\mathbf{X},\mathbf{F}(\mathbf{X},t)) $$
cioè il primo tensore di Piola-Kirchhoff dipende dalla deformazione ma non dalle sue derivate, ad esempio dalla velocità come nel caso dei fluidi e dei corpi viscosi.
\paragraph{Materiali iperelastici}
Un materiale si dice iperelastico se esiste una funzione detta funzione energia  $\widehat{\mathbf{W}}$ tale che 
$$\widehat{\mathbf{P}}(\mathbf{X},\mathbf{F}(\mathbf{X},t))=\rho_{\mathcal{B}}\frac{\partial \widehat{\mathbf{W}}}{\partial \mathbf{F}} $$
\paragraph{\emph{Indipendenza dal sistema di riferimento}}
Le leggi costitutive del corpo in esame non devono dipendere dal particolare sistema di riferimento usato per descriverlo.
In particolare sia $\mathbf{Q}$ una matrice ortogonale, allora 
$$\mathbf{T}(\mathbf{X},\mathbf{F},\mathbf{N}) = \widehat{\mathbf{P}}(\mathbf{X},\mathbf{F})\mathbf{N} $$
$$\widehat{\mathbf{P}}(\mathbf{X},\mathbf{Q}\mathbf{F}) = \mathbf{Q}\widehat{\mathbf{P}}(\mathbf{X},\mathbf{F}) $$
Per un materiale iperelastico 
$$\widehat{\mathbf{W}}(\mathbf{X},\mathbf{Q}\mathbf{F}) = \widehat{\mathbf{W}}(\mathbf{X},\mathbf{F}) $$
e quindi
$$\widehat{\mathbf{W}}(\mathbf{X},\mathbf{F}) = \widehat{\mathbf{W}}(\mathbf{X},\sqrt{\mathbf{C}}) $$
L'indipendenza dal sistema di riferimento implica la conservazione momento angolare e la simmetria dei tensori di stress.
\paragraph{Materiali isotropici}
Un materiale è omogeneo se $\widehat{\mathbf{P}}$ non dipende esplicitamente da $\mathbf{X}$, cioè il comportamento del materiale non dipende dal punto del materiale in esame ma solo dalla sua deformazione.

Un materiale è isotropico se
$$\widehat{\mathbf{P}}(\mathbf{X},\mathbf{Q}\mathbf{F}) = \widehat{\mathbf{P}}(\mathbf{X},\mathbf{F}) $$
per ogni matrice ortogonale $\mathbf{Q}$.
Inoltre se un materiale è iperelastico vale 
$$\widehat{\mathbf{W}}(\mathbf{X},\mathbf{F}\mathbf{Q}) = \widehat{\mathbf{W}}(\mathbf{X},\mathbf{F}) $$

Un materiale è iperelastico, indipendente dal sistema di riferimento, omogeneo e isotropico se e solo se
$$\widehat{\mathbf{W}}(\mathbf{F}) = \Phi(\lambda_1,\lambda_2,\lambda_3) $$
con $\Phi$ funzione simmetrica degli sforzi principali $\lambda_1$, $\lambda_2$ e $\lambda_3$.
Si può mostrare inoltre che
$$\mathbf{S}=\alpha_0\mathbf{I}+\alpha_1\mathbf{C}+\alpha_2\mathbf{C}^2 $$
e
$$\boldsymbol{\sigma}=\beta_0\mathbf{I}+\beta_1\mathbf{b}+\beta_2\mathbf{b}^2 $$
con $\alpha_i$ e $\beta_i$ funzioni scalari degli invarianti di $\mathbf{C}$  e di $\mathbf{b}$.
\paragraph{Elasticità lineare}
Quando il corpo in esame è soggetto solo a piccoli spostamenti e a piccole deformazioni è possibile ottenere una teoria semplificata linearizzando le equazioni non lineari del moto.

Sia $\widehat{\mathbf{P}}$ la funzione costitutiva di un materiale elastico omogeneo non lineare tale che $\widehat{\mathbf{P}}(\mathbf{I})=0$, cioè la configurazione di riferimento ha stress nullo.
Sia $\phi_\epsilon(\mathbf{X},t)$ una famiglia di moti dipendenti dal parametro $\epsilon \ll1$ tale che $\phi_0(\mathbf{X},t) = \mathbf{X}$. Quindi $\phi_0$ soddisfa le equazioni del moto
$$\rho_\mathcal{B}\frac{\partial \mathbf{V}}{\partial t} = \Nabla\cdot\widehat{\mathbf{P}}(\mathbf{F}) $$.
Si supponga che anche $\phi_\epsilon$ soddisfi la stessa equazione per ogni $\epsilon$.
Sia 
$$\phi_\epsilon(\mathbf{X},t) = \mathbf{X}+\epsilon\mathbf{u}(\mathbf{X},t) + \mathcal{O}(\epsilon^2)$$
l'espansione in serie di $\phi_\epsilon$.
Il problema di riduce a trovare $\mathbf{u}$.
Osservato che 
$$\mathbf{u}=\frac{\partial}{\partial \epsilon}\phi_\epsilon \big|_{\epsilon=0}$$
e
$$\frac{\partial}{\partial t}\mathbf{u}=\frac{\partial}{\partial \epsilon}\mathbf{V}_\epsilon \big|_{\epsilon=0}$$
differenziando l'equazione (?.?) si ottiene
$$\rho_{\mathcal{B}} \frac{\partial}{\partial \epsilon}\mathbf{V}_\epsilon = \Nabla\cdot\widehat{\mathbf{P}}(\mathbf{F_\epsilon)}$$
che in $\epsilon=0$ vale
$$\rho_{\mathcal{B}} \frac{\partial^2\mathbf{u}^i}{\partial t^2} = \frac{\partial}{\partial \mathbf{X}^j}(\frac{\partial\widehat{\mathbf{P}}^{ij}}{\partial\mathbf{F}^k_l}(\mathbf{I})\frac{\partial\mathbf{u}^k}{\partial\mathbf{X}^l})$$
Definiamo il tensore classico di elasticità come
$$ c_{ijkl}(\mathbf{X})= \frac{\partial\widehat{\mathbf{P}}^{ij}}{\partial\mathbf{F}^k_l}(\mathbf{I})$$.
Se il materiale è omogeneo allora i valori di $c_{ijkl}$ sono costanti in tutto il corpo e l'equazione dell'elasticità lineare diventa
$$\rho_{\mathcal{B}} \frac{\partial^2\mathbf{u}^i}{\partial t^2} = \frac{\partial^2\mathbf{u}^k}{\partial\mathbf{X}^j\partial\mathbf{X}^l}$$.
Se il materiale è omogeneo e isotropico allora esistono due costani $\lambda$ e $\mu$ dette moduli di Lamè per cui
$$c_{ijkl}=\lambda\delta_{ij}\delta_{kl}+\mu(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk})$$.
\paragraph{Un fluido elastico}
Si consideri un corpo non lineare iperelastico per cui
$$\widehat{W}(\mathbf{F}) = h(|\mathbf{F}|)$$.
Allora è omogeneo, indipendente dal sistema di riferimento e isotropico e il primo tensore di Piola-Kirchhoff vale
$$\widehat{\mathbf{P}}=\rho_{\mathcal{B}}\frac{\partial \widehat{W}}{\partial \mathbf{F}} = \rho_{\mathcal{B}}h'(J)\frac{\partial \mathbf{J}}{\partial \mathbf{F}}$$
con $J = |\mathbf{F}|$.
Osservato che 
$$\frac{\partial J}{\partial \mathbf{F}} = J\mathbf{F}^{-T}$$
allora il tensore di stress di Cauchy vale
$$\boldsymbol{\sigma}=(\frac{1}{J})\widehat{\mathbf{P}}\mathbf{F}^{T}=\rho_{\mathcal{B}}h'(J)\mathbf{I}$$.
Dato che
$$p(\rho)=-\rho_{\mathcal{B}}h'(J)$$
allora
$$\boldsymbol{\sigma}=-p(\rho)\mathbf{I}$$.
L'equazione del moto di Cauchy diventa
$$\rho\frac{D \mathbf{u}}{Dt} = -\Nabla p+\rho\mathbf{b}$$
che è l'equazione di Eulero per i fluidi perfetti comprimibili, che quindi sono un sottoinsieme dei materiali elastici.
Nei fluidi viscosi invece $\boldsymbol{\sigma}$ dipende non solo da $\mathbf{F}$ ma anche da $\Nabla\mathbf{v}$.
[distinguere fluidi da solidi mediante gruppo di simmetria]
\paragraph{Incomprimibilità}
Un materiale è incomprimibile se...
e quindi $J\equiv 1$ o $\Nabla\cdot\mathbf{v}=0$.
Il moltiplicatore di Lagrange associato a questo vincolo
$$\mathbf{P}(\mathbf{X},t)=-p\mathbf{F}^{-T}+\widehat{\mathbf{P}}(\mathbf{X},\mathbf{F}(\mathbf{X},t))$$.

Per $\widehat{\mathbf{P}}=0$  si ottiene l'equazione di Eulero per i fluidi perfetti incomprimibili
$$\rho\frac{D \mathbf{v}}{Dt} = -\Nabla p+\rho\mathbf{b}$$
$$\Nabla\cdot\mathbf{v}=0$$
\paragraph{Materiali di Mooney-Rivlin}

%Heltai

\section{Teoria dell'elasticità strikes back}
[coordinate euleriane e lagrangiane]

\paragraph{Il teorema del trasporto}

\begin{theorem}[del Trasporto di Reynolds]
	Sia $\Phi(\mathbf{x},t)$ una funzione scalare o vettoriale, $\mathcal{P}\subset\mathcal{B}$ una porzione regolare del corpo in esame e  $\mathcal{P}_t = \mathbf{X}(\mathcal{P},t)$ la stessa porzione al tempo $t$ allora
	$$\forall t \in (0,T)\> \frac{d}{dt}\int_{\mathcal{P}_t}\Phi(\mathbf{x},t)\,d\mathbf{x}=\int_{\mathcal{P}_t}\frac{D\Phi}{Dt}(\mathbf{x},t)+\Phi(\mathbf{x},t)\Nabla\cdot\mathbf{u}(\mathbf{x},t)\,d\mathbf{x}$$
\end{theorem}

Le equazioni di conservazione possono essere ricavate applicando il teorema del trasporto.

\paragraph{Conservazione del volume}
Applicando il teorema di Reynolds alla funzione $\Phi \equiv 1$ si ottiene la legge di conservazione del volume
$$\frac{d}{dt}\int_{\mathcal{P}_t}\,d\mathbf{x}=\int_{\mathcal{P}_t}\Nabla\cdot\mathbf{u}\,d\mathbf{x}=\int_{\partial\mathcal{P}_t}\mathbf{u}\cdot\mathbf{n}\,d\mathbf{x} $$.
Se il materiale è incomprimibile allora $\Nabla\cdot\mathbf{u}=0$.

\paragraph{Conservazione della massa}
Sia $M(\mathbf{s})$ la densità di massa del punto materiale $\mathbf{s}$ e 
$$\rho(\mathbf{x},t)=M(\mathbf{X}(\mathbf{x},t))$$
la densità di massa in coordinate euleriane.
Applicando il principio di conservazione della massa si ottiene
$$\frac{d}{dt}\int_{\mathcal{P}_t}\rho\,d\mathbf{x}=\int_{\mathcal{P}_t}\frac{D\rho}{Dt}+\rho\Nabla\cdot\mathbf{u}\,d\mathbf{x}=0$$.
Se inoltre il materiale è incomprimibile allora 
$$\frac{D\rho}{Dt}(\mathbf{x},t)=0 $$.
e applicando il teorema di Reynold alla funzione $\rho\Phi$ si ottiene
$$\frac{d}{dt}\int_{\mathcal{P}_t}\rho\Phi\,d\mathbf{x}=\int_{\mathcal{P}_t}\frac{D(\rho\Phi)}{Dt}+\rho\Phi\Nabla\cdot\mathbf{u}\,d\mathbf{x}=\int_{\mathcal{P}_t}(\frac{D\rho}{Dt}+\rho\Nabla\cdot\mathbf{u})\Phi+\rho\frac{D\Phi}{Dt}\,d\mathbf{x}=\int_{\mathcal{P}_t}\rho\frac{D\Phi}{Dt}\,d\mathbf{x}$$.
Quindi in un materiale incomprimibile la densità di massa si comporta come una costante per quanto riguarda l'operazione di derivazione materiale.

\paragraph{Conservazione della quantità di moto}
Sia
$$\mathbf{p}(\mathcal{P},t)=\int_{\mathcal{P}_t}\rho\mathbf{u}\,d\mathbf{x}$$
la quantità di moto della porzione di corpo $\mathcal{P}$
e
$$\mathbf{L}(\mathcal{P},t)=\int_{\mathcal{P}_t}\rho\mathbf{x}\times\mathbf{u}\,d\mathbf{x}$$
il momento angolare.
Applicando il teorema di Reynolds si ottiene
$$\frac{D\mathbf{p}}{Dt}=\int_{\mathcal{P}_t}\rho\frac{D\mathbf{u}}{Dt}\,d\mathbf{x}$$
$$\frac{D\mathbf{L}}{Dt}=\int_{\mathcal{P}_t}\rho\mathbf{x}\times\frac{D\mathbf{u}}{Dt}\,d\mathbf{x}$$
Enunciamo ora la prima legge di Newton
\begin{theorem}
	Sia $\mathbf{f}(\mathcal{P},t)$ la risultante delle forze applicate alla porzione di corpo $\mathcal{P}$ al tempo $t$ allora
	$$\mathbf{f}((\mathcal{P},t))=\frac{D\mathbf{p}}{Dt}((\mathcal{P},t))$$
\end{theorem}
Si possono distinguere due tipi di forze, le forze di volume che sono applicate ad ogni punto del materiale, e le forze di contatto, responsabili dell'interazione tra sottoinsiemi del materiale.
Siano $\mathbf{b}(\mathbf{x},t)$ la densità di forze di volume e $\mathbf{t}(\mathbf{x},t,\mathbf{n})$ la densità di forze di contatto. Verrano considerati solo materiali di Cauchy in cui la densità di forza di contatto dipende solo dalla normale alla superficie e non dalla curvatura della stessa.
La forza applicata da una regione del corpo su di un'altra regione attraverso la superficie $\mathcal{S}$ è data da
$$\int_{\mathcal{S}}\mathbf{t}(\mathbf{n},\mathbf{x},t)\,da$$.
La prima legge di Newton per un materiale di Cauchy diventa
$$\mathbf{f}((\mathcal{P},t))=\frac{D\mathbf{p}}{Dt}((\mathcal{P},t)) = \int_{\partial\mathcal{P}_t}\mathbf{t}+\int_{\mathcal{P}_t}\mathbf{b}$$
Che è equivalente a chiedere che valga il principio dei lavori virtulali, cioè che per ogni $\mathcal{P}$, $t$ e per ogni $\mathbf{n}$ esista un tensore simmetrico $\boldsymbol{\sigma}$ detto tensore di stress di Cauchy tale che $\mathbf{t}(\mathbf{x},t,mathbf{n})=\boldsymbol{\sigma}(\mathbf{x},t)\mathbf{n}$ e
$$\int_{\mathcal{P}_t}\frac{D\mathbf{u}}{Dt}\cdot\mathbf{v}\,d\mathbf{x}+\int_{\mathcal{P}_t}\boldsymbol{\sigma}\boldsymbol{:}\Nabla\mathbf{v}\,d\mathbf{x}=\int_{\partial\mathcal{P}_t}\boldsymbol{\sigma}\mathbf{n}\cdot\mathbf{v}\,d\mathbf{x}+\int_{\mathcal{P}_t}\mathbf{b}\cdot\mathbf{v}\,d\mathbf{x}$$
per ogni funzione di test $\mathbf{v}$ sufficientemente regolare a supporto compatto in $\Omega$.
[$$\boldsymbol{\sigma}\boldsymbol{:}\Nabla\mathbf{v}=\sigma_{\alpha\beta}\frac{\partial v_{\alpha}}{\partial x_{\beta}}$$].
Se $\boldsymbol{\sigma}$ è sufficiente regolare allora vale la versione puntuale dell'equazione
$$\rho\frac{D\mathbf{u}}{Dt}=\Nabla\cdot\boldsymbol{\sigma}+\mathbf{b}$$.
Si può notare che in dimensione $d=2$ l'equazione fornisce $2$ condizioni per $2(\mathbf{u})+3(\boldsymbol{\sigma})$ incognite, mentre in dimensione $d=3$ l'equazione fornisce $3$ condizioni per $3(\mathbf{u})+6(\boldsymbol{\sigma})$.
I rimanenti gradi di libertà possono essere utilizzati per modellizzare vari tipi di materiali differenti, ad esempio i fluidi viscosi e i materiali elastici.


Un corpo si dice elastico se tende a ritornare nella sua configurazione originale ( o di equilibrio ) dopo essere stato deformato. Le particelle di un corpo elastico tendono a recuperare la loro posizione relativa rispetto alle altre particelle, mentre in un fluido il comportamento è stabilito solo dalla loro velocità relativa.

\paragraph{Materiali iperelastici}

Un materiale incomprimibile si dice iperelastico se è possibile definire una funzione di densità di energia potenziale

$W( \mathbb{F},\mathbf{s}) > 0$

associata alla deformazione $\mathbb{F}$.

Il comportamento di un materiale iperelastico dipende solo dalla sua configurazione attuale e non presenta fenomeni di isteresi.

Sia $E [  \mathbf{X}(t) ] = \int_{\omega} W( \mathbb{F}, \mathbf{s} )) \, d\mathbf{s}$ l'energia potenziale totale del corpo.

Grazie ad alcune considerazione fisiche possiamo caratterizzare la funzione $W$:

1. In assenza di deformazione non c'è energia accumulata nel corpo $W(\mathbb{I}) = 0$

2. la densità di energia diverge a $+\infty$ quando il corpo viene compresso o espanso indefinitamente  

$\vert \mathbb{F} \vert \rightarrow 0 \Rightarrow W(\mathbb{F}) \rightarrow +\infty$

$\vert \mathbb{F} \vert \rightarrow +\infty \Rightarrow W(\mathbb{F}) \rightarrow +\infty$

3.  la densità di energia non varia in seguito a moti rigidi del corpo, cioè se $\mathbb{F}^*$ è ottenuta con un moto rigido da $\mathbb{F}$ allora $W(\mathbb{F}^*) = W(\mathbb{F})$.

Sappiamo già [dove?] che $\mathbb{F}$ non cambia in seguito a traslazioni rigide, quindi possiamo scrivere

$\mathbb{F}^* = R\mathbb{F}$ con $R$ rotazione tale che $RR^T = \mathbb{I}$ e $\Vert R \Vert > 0$.

Ogni gradiente di deformazione $\mathbb{F}$ può essere scritto come il prodotto tra una rotazione e la sua componente puramente di deformazione $\mathbb{U}$ [non ha senso sta roba, o meglio non ne ha solo 1]. Quindi

$W(\mathbb{F}) = W(R\mathbb{U}) = W(\mathbb{U})$.

Possiamo ora definire il tensore di Cauchy-Green e il tensore di Green

$\mathbb{C} = \mathbb{F}^T\mathbb{F} = \mathbb{U}^T\mathbb{U}$

$\mathbb{G} = \frac{1}{2}(\mathbb{C}-\mathbb{I})$

che sono indipendenti da moti rigidi del corpo. [quindi W è più bella se definita in termini di questi due]

Per calcolare lo sforzo generato nel materiale dai tensori è conveniente introdurre i tensori di Piola-Kirchhoff, che ne sono la riscrittura in termini di coordinate lagrangiane

$(\mathbb{P}(\mathbf{s},t))_{\alpha,\beta} = \frac{\partial W}{\partial \mathbb{F}_{\alpha,\beta}} (\mathbf{s},t) =( \frac{\partial W}{\partial \mathbb{F}} (\mathbf{s},t))_{\alpha,\beta}$

$\mathbb{S}(\mathbf{s},t)=\frac{\partial W}{\partial\mathbb{G}}(\mathbf{s},t)=2\frac{\partial W}{\partial\mathbb{C}}(\mathbf{s},t)$

[]

$\int_{\partial\mathcal{P}_t} \mathbf{\sigma}\mathbf{n} \, dA = \int_{\partial\mathcal{P}} \mathbb{P}\mathbf{N} \, dA$

$\mathbb{P}(\mathbf{s},t) = \vert \mathbb{F}(\mathbf{s},t) \vert \mathbf{\sigma}(\mathbf{X}(\mathbf{s},t),t) \mathbb{F}^{-T}(\mathbf{s},t)$


Possiamo scrivere la legge di conservazione del momento in termini del primo tensore di P.K.

$M\frac{\partial^2\mathbf{X}}{\partial t^2} = \Nabla_\mathbf{s} \cdot \mathbb{P} + \mathbf{B}$

con 

$(\Nabla_\mathbf{s} \cdot \mathbb{P} )_{\alpha} = \frac{\partial\mathbb{P}_{\alpha,\beta}}{\partial s_\beta}$

\paragraph{Incomprimibilità}

Come già visto prima $\vert \mathbb{F} \vert = 1$.

[questo crea un casino e bisogna aggiungere un moltiplicatore di Lagrange associato alla condizione di incomprimibilità nell'equazione della pressione idrostatica wut?]

[modello neohookeano]

\paragraph{Materiali viscoelastici}

\subsection{Equazioni in forma forte}

Sia $\mathcal{B} \subseteq \Re^3$ una regione poligonale convessa sulla cui superficie $\partial\mathcal{B}$ è applicata una forza con densità per superficie $\mathbf{T}$.

Dati $\mathbf{X}_0$, $\mathbf{X}^{'}_0$ e $\mathbf{T}$ trovare $\mathbf{X}$ e $P$ tali che:
$$\frac{\partial^2\mathbf{X}}{\partial t^2} = \Nabla_\mathbf{s} \cdot \mathbb{P}$$
$$\mathbb{P} = \frac{\partial W}{\partial\mathbb{F}} - \vert\mathbb{F}\vert P\mathbb{F}^{-T} + \eta\vert\mathbb{F}\vert \frac{\partial}{\partial t}(\mathbb{F}\mathbb{F}^{-T} + (\mathbb{F}\mathbb{F}^{-T})^T)\mathbb{F}^{-T}$$
$$\vert\mathbb{F}\vert=1$$
$$\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(s)$$
$$\frac{\partial \mathbf{X}}{\partial t}(\mathbf{s},0)=\mathbf{X}^{'}_0(\mathbf{s})$$
$$\mathbb{P}\mathbf{N}=-\mathbf{T}$$

\subsection{Equazioni in forma debole}

Sia $S = \{ \mathbf{X} \in H^1(\mathcal{B})^d \cap W^{1,\infty}(\mathcal{B})^d \quad \texttt{t.c.} \quad \vert \boldsymbol {\nabla}_{\mathbf{s}}\mathbf{X}\vert = \vert \mathbb{F} \vert > 0, \mathbf{X}(\mathcal{B}) \subseteq \Omega \}$ lo spazio delle configurazioni ammesse e $P = L^2(\mathcal{B})^d$

Dati $\mathbf{T} \in H^{-\frac{1}{2}}(\partial\mathcal{B}^d$ e $\mathbf{X}_0,\mathbf{X}^{'}_0 \in S$ per ogni $t \in ]0,t[$ trovare $\mathbf{X}(t) \in S$ tale che 
$$\frac{d^2}{dt^2} < \mathbf{X}(t), \mathbf{Y} > + < \mathbb{P}(\mathbb{F}(t)), \Nabla_\mathbf{s} \mathbf{Y} = -\int_{\partial\mathcal{B}}\mathbf{T}(t)\cdot\mathbf{Y}\,dA$$
$$\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(\mathbf{s})$$
$$\frac{\partial\mathbf{X}}{\partial t}(\mathbf{s},0)=\mathbf{X}^{'}_0(\mathbf{s})$$

Le equazioni possono essere scritte in termini di operatori come fatto per le equazioni di N.S.

\paragraph{Stima dell'energia}

Presi $\mathbf{B}=0$ e $\mathbf{T}=0$ nelle equazioni allora
$$\frac{1}{2}\frac{d}{dt}\Vert\mathbf{U}(t)\Vert^2_{0,\mathcal{B}}+\frac{d}{dt}E[\mathbf{X}(t)]=0$$
[prendendo $\mathbf{Y}=\mathbf{U}$ nelle equazioni].

\chapter{Le interazioni fluido struttura}

Nello studio delle interazione tra un fluido e una struttura ci si trova ad affrontare il problema di avere da una parte un fluido, il cui comportamento è descritto dalle equazioni di Navier-Stokes, e quindi totalmente caratterizzato dal valore della velocità e della pressione espresse in coordinate euleriane, e dall'altra un corpo elastico, il cui comportamento dipende nella maggioranza dei casi dalla sua deformazione rispetto alla posizione di equilibrio espressa in coordinate lagrangiane.

\section{Il Metodo \IB di Peskin}

%The immersed boundary method, C.S. Peskin, Acta Numerica, 2002
Il metodo \textit{Immersed Boundary} ha lo scopo di studiare e simulare numericamente le interazioni tra un fluido e una struttura elastica immersa nel fluido. Il metodo è stato ideato da Charles Peskin negli anni settanta per lo studio del flusso sanguigno nel cuore attorno alle valvole cardiache ed è stato poi adattato per risolvere un vasto numero di problemi sia biologici che fisici[citation needed]. [Numerical Analysis of Blood Flow in Heart, 1977, Journal of Computational Physics]

Uno dei principali problemi nelle interazioni fluido-struttura è che mentre il fluido è descritto in coordinate euleriane il materiale elastico è descritto in coordinate lagrangiane, e solo con molta difficoltà è possibile scrivere espicitamente entrambi i sistemi di equazioni che governano il fluido e la struttura rispettivamente sfruttando lo stesso insieme di variabili. Il metodo \IB inoltre permette di affrontare questo problema senza dover ricalcolare per ogni step temporale la mesh, al contrario dei metodi \textit{ALE}, sfruttando la funzione $\delta$ di Dirac per legare i due ambienti, quello euleriano e quello lagrangiano.

Nella sua versione continua il metodo consiste nel considerare contemporaneamente le equazioni del fluido e della struttura. A queste, per evitare di dover riscrivere esplicitamente un insieme di equazioni nelle  coordinate e nelle variabili dell'altro, vanno aggiunte le equazioni che mettono in contatto i due differenti ambienti accoppiando le grandezze coinvolte mediante la funzione delta di Dirac. Viene calcolata la forza che la struttura elasitica esercita sul fluido e lo spostamento che il fluido induce nella struttura.

Dal punto di vista dell'approssimazione numerica il metodo \IB permette di usare una mesh fissa per le variabili euleriane e una mesh curvilinea in movimento per le variabili lagrangiane che non deve adattarsi alla prima mesh. Le variabili euleriane e lagrangiane sono collegate da equazioni di interazione che nella versione originale del metodo, basato sulle differenze finite, sfruttava una opportuna approssimazione della funzione delta di Dirac che per garantire buone proprietà allo schema numerico era necessario che soddisfasse alcune condizioni e che avesse alcune proprietà. La formulazione variazionale del metodo \IB, riuscendo a descrivere in modo naturale l'effetto della funzione $\delta$ di Dirac, non necessità di nessuna approssimazione della funzione delta.

\subsection{Le equazioni del problema}

Il punto centrale del metodo è lo sfruttamento della funzione $\delta$ di Dirac per collegare le grandezze definite in variabili euleriane delle equazioni di Navier-Stokes alle corrispettive grandezze definite in variabili lagrangiane delle equazioni del materiale elastico, in particolare la velocità del fluido e della struttura e la forza che il fluido e la struttura applicano l'uno sull'altra.

Usando la stessa notazione usata nell'introduzione introduciamo il problema continuo dei problemi di interazione fluido-struttura.

\begin{problem}
Date $\mathbf{u}_0$, $\mathbf{X}_0$ e $\mathbf{U}_0$ trovare $\mathbf{u}$,$p$,$\mathbf{X}$,$\mathbf{U}$,$P$ che soddisfano
\begin{equation}
\begin{aligned}
\rho \left ( \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \Nabla \mathbf{u} \right ) &= \eta \Delta \mathbf{u} - \nabla p \\
\Nabla \cdot \mathbf{u} &= 0 \\
\mathbf{u}(\mathbf{x},t)&=0 \\
\mathbf{u}(\mathbf{x},0)&=\mathbf{u}_0(\mathbf{x}) \\
\frac{\partial \mathbf{U}}{\partial t} &= \nabla_s\cdot\mathbb{P}\\
\frac{\partial \mathbf{X}}{\partial t} &= \mathbf{U}\\
\mathbb{P} &= \frac{\partial W}{\partial \mathbb{F}}-|\mathbb{F}|\mathbb{P}\mathbb{F}^{-T}+\eta|\mathbb{F}|\frac{\partial}{\partial t}(\mathbb{F}\mathbb{F}^{-T}+(\mathbb{F}\mathbb{F}^{-T})^{T})\mathbb{F}^{-T}\\
|\mathbb{F}|&=1\\
\mathbf{X}(\mathbf{s},0)&=\mathbf{X}_0(\mathbf{s})\\
\mathbf{U}(\mathbf{s},0)&=\mathbf{U}_0(\mathbf{s})\\
-p\mathbf{n}+2\eta\mathcal{D}(\mathbf{n})\mathbf{n}&=\mathbb{P}\mathbb{F}^T\mathbf{n}\\
\mathbf{u}(\mathbf{X}(\mathbf{s},t))&=\mathbf{U}(\mathbf{s},t)
\end{aligned}
\end{equation}
\end{problem}
Si può notare che le equazioni 1-? sono le equazioni di Navier-Stokes, le seguenti equazioni quelle che governano il comportamento della strutture mentre le ultime due sono le equazioni che legano le variabili euleriane e lagrangiane.[]

\subsection{Le equazioni del metodo \IB}
Pur essendo possibile studiare il problema da un punto di vista teorico lasciando ogni equazione definita nelle sue variabili naturali, euleriane per il fluido, lagrangiane per la struttura, questo rende difficile studiare il problema dal punto di vista dell'approssimazione numerica. Il metodo \emph{Immersed Boundary} cerca di risolvere questa difficoltà senza scrivere esplicitamente le equazioni in un insieme di variabili comuni, ma piuttosto lega le grandezze dei due ambienti mediante l'utilizzo della funzione $\delta$ di Dirac.
\begin{problem}
Date $\mathbf{u}_0$, $\mathbf{X}_0$ e $\mathbf{U}_0$ trovare $\mathbf{u}$,$p$,$\mathbf{X}$,$\mathbf{U}$,$P$ che soddisfino
\begin{equation}
\begin{aligned}
\rho \left ( \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \Nabla \mathbf{u} \right ) = \eta \Delta \mathbf{u} - \nabla p \\
\Nabla \cdot \mathbf{u} = 0 \\
\mathbf{u}(\mathbf{x},t)=0 \\
\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x}) \\
\frac{\partial \mathbf{X}}{\partial t} = \mathbf{u}(\mathbf{X}(\mathbf{s},t))\\
\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(\mathbf{s})\\
%\rho(\mathbf{x},t)=\int M(\mathbf{s},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}\\
\mathbf{f}(\mathbf{x},t)=\int \mathbf{F}(\mathbf{s},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}\\
\frac{\partial\mathbf{X}}{\partial t}(\mathbf{s},t)=\mathbf{u}(\mathbf{X}(\mathbf{s},t),t)=\int \mathbf{u}(\mathbf{x},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{x}\\
\mathbf{F}(\mathbf{s},t)=-\frac{\partial W}{\partial \mathbf{X}}\\
\end{aligned}
\end{equation}
\end{problem}
La formulazione originale [Peskin1], sfruttando il metodo delle differenze finite, prevede di dover approssimare opportunamente la funzione $\delta$ di Dirac. Usando il metodo degli elementi finiti non è necessario approssimare la funzione $\delta$ di Dirac che viene infatti trattata in modo naturale nella formulazione debole delle equazioni.

\subsection{Formulazione iperelastica}
Le equazioni del paragrafo precedente sono adatte per descrivere strutture elastiche di codimensione pari a $1$, ma non riescono a descrivere correttamente le forze di trasmissione tra il corpo e il fluido quando la struttura ha codimensione $0$. Per poter fare ciò imponiamo che il tensore di Cauchy sia continuo in tutto lo spazio e che sia possibile decomporlo come
\begin{equation}
\begin{aligned}
\boldsymbol{\sigma} = &\boldsymbol{\sigma}_f\\
                    &\boldsymbol{\sigma}_f + \boldsymbol{\sigma}_s\\
\end{aligned}
\end{equation}
e che lo stesso sia possibile per il primo tensore di Piola-Kirchhoff
\begin{equation}
\begin{aligned}
\mathbb{P} = &\mathbb{P}_f\\
                    &\mathbb{P}_f + \mathbb{P}_s\\
\end{aligned}
\end{equation}

E' Possibile quindi riscrivere il principio dei lavori virtuali come
\begin{equation}
\int_\Omega \rho\frac{D\mathbf{u}}{Dt}\cdot \mathbf{v} \, d\mathbf{x} + \int_\Omega \boldsymbol{\sigma}_f \boldsymbol{:} \Nabla \mathbf{v} \, d\mathbf{x} + \int_{\mathcal{B}_t} \boldsymbol{\sigma}_s \boldsymbol{:} \Nabla \mathbf{v} \, d\mathbf{x} = 0
\end{equation}
e quindi
\begin{equation}
\int_\Omega \rho\frac{D\mathbf{u}}{Dt}\cdot \mathbf{v} \, d\mathbf{x} + \int_\Omega \boldsymbol{\sigma}_f \boldsymbol{:} \Nabla \mathbf{v} \, d\mathbf{x} + \int_\mathcal{B} \mathbb{P}_s \boldsymbol{:} \Nabla_s \mathbf{V} \, d\mathbf{s} = 0
\end{equation}
dove $\mathbf{V}(\mathbf{s},t)=\mathbf{V}(X(\mathbf{s},t))$.
Integrando ora per parti si ottiene
\begin{equation}
\int_\Omega \left ( \rho\frac{D\mathbf{u}}{Dt}\cdot \mathbf{v} \, d\mathbf{x} - \nabla \cdot \boldsymbol{\sigma}_f \right ) \cdot \mathbf{v} \, d\mathbf{x} = \int_\mathcal{B} (\nabla_s \cdot\mathbb{P}_s) \cdot \mathbf{V} \, d\mathbf{s} -\int_{\partial \mathcal{B}} \mathbb{P}_s\mathbf{N} \cdot \mathbf{V} \, dA
\end{equation}
Definite la densità di forza interna $G$ e la forza  di trassissione $T$ come
$$\mathbf{G}(\mathbf{s},t)=\nabla_s \mathbb{P}_s(\mathbf{s},t)$$
$$\mathbf{T}(\mathbf{s},t)=-\mathbb{P}_s(\mathbf{s},t)\mathbf{N}(\mathbf{s})$$
possiamo riscrivere i due termini al secondo membro dell'equazione [] come
\begin{equation}
\int_\mathcal{B} (\nabla_s \cdot\mathbb{P}_s) \cdot \mathbf{V} \, d\mathbf{s} = \int_\mathcal{B}(\nabla_s\cdot\mathbb{P}_s)\cdot\int_\Omega\mathbf{v}(\mathbf{x})\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\, d\mathbf{x}\, d\mathbf{s} = \int_\Omega \int_\mathcal{B}(\nabla_s\cdot\mathbb{P}_s)\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\, d\mathbf{s}\cdot\mathbf{v}(\mathbf{x})\, d\mathbf{x} = \int_\Omega \mathbf{g}(\mathbf{x},t) \cdot\mathbf{v}(\mathbf{x})\, d\mathbf{x}
\end{equation}
e
\begin{equation}
\int_{\partial \mathcal{B}} \mathbb{P}_s(\mathbf{s},t)\mathbf{N}(\mathbf{s}) \cdot \mathbf{V}(\mathbf{s},t)) \, dA = \int_{\partial \mathcal{B}} \mathbb{P}_s(\mathbf{s},t)\mathbf{N}(\mathbf{s}) \cdot \int_\Omega\mathbf{v}(\mathbf{x})\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\, d\mathbf{x}\, dA = \int_\Omega \int_{\partial \mathcal{B}}\mathbb{P}_s(\mathbf{s},t)\mathbf{N}(\mathbf{s})\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t)) \, dA \cdot \mathbf{v}(\mathbf{x})\, d\mathbf{x} = - \int_\Omega \mathbf{t}(\mathbf{x},t) \cdot\mathbf{v}(\mathbf{x})\, d\mathbf{x} 
\end{equation}
e quindi possiamo riscrivere [] come
\begin{equation}
\rho\frac{D\mathbf{u}}{Dt}-\nabla\cdot\bsigma_f = \mathbf{g}+\mathbf{t} = \int_{\mathcal{B}}\mathbf{G}(\mathbf{s},t)\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}+
\int_{\partial \mathcal{B}}\mathbf{T}(\mathbf{s},t)\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,dA
\end{equation}
e il problema [] diventa
\begin{problem}
	\begin{equation}
\begin{aligned}
	\rho \left ( \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \Nabla \mathbf{u} \right ) = \eta \Delta \mathbf{u} - \nabla p \\
	\Nabla \cdot \mathbf{u} = 0 \\
	\mathbf{u}(\mathbf{x},t)=0 \\
	\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x}) \\
	\frac{\partial \mathbf{X}}{\partial t} = \mathbf{u}(\mathbf{X}(\mathbf{s},t))\\
	\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(\mathbf{s})\\
	%\rho(\mathbf{x},t)=\int M(\mathbf{s},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}\\
		\mathbf{g}(\mathbf{x},t)=\int_{\mathcal{B}}\mathbf{G}(\mathbf{s},t)\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}\\
	\mathbf{t}(\mathbf{x},t)=\int_{\partial \mathcal{B}}\mathbf{T}(\mathbf{s},t)\boldsymbol{\delta}(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,dA\\
		\mathbf{G}(\mathbf{s},t)=\Nabla_{\mathbf{s}}\cdot\mathbb{P}_{\mathbf{s}}(\mathbf{s},t)\\
			\mathbf{T}(\mathbf{s},t)=-\mathbb{P}_{\mathbf{s}}(\mathbf{s},t)\mathbf{N}(\mathbf{s})\\
	\mathbf{f}(\mathbf{x},t)=\int \mathbf{F}(\mathbf{s},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{s}\\
	\frac{\partial\mathbf{X}}{\partial t}(\mathbf{s},t)=\mathbf{u}(\mathbf{X}(\mathbf{s},t),t)=\int \mathbf{u}(\mathbf{x},t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{s},t))\,d\mathbf{x}\\
	\mathbf{F}(\mathbf{s},t)=-\frac{\partial W}{\partial \mathbf{X}}\\
\end{aligned}
\end{equation}
\end{problem}

\subsection{[Codimensione e deformazione]}
[?]

\section{Formulazione variazionale}
La versione originale del metodo Immersed Boundary sviluppata da Peskin sfrutta il metodo delle differenze finite per la discretizzazione spaziale delle equazioni. Per fare ciò è necessario introdurre una approssimazione $\boldsymbol{\delta}_h$ della funzione $\boldsymbol{\delta}$, tendente a $\boldsymbol{\delta}$ per $h\to 0$, in modo che le sue proprietà permettano di ottenere la stabilità e una buona velocità di convergenza del metodo numerico.[vedi 49 di heltai,articoli peskin]

La formulazione variazionale permette di superare questo problema in quanto la funzione $\boldsymbol{\delta}$ è gestibile senza necessità di approssimazione in forma debole.

Siano 
$$V=H^1_0(\Omega)^d=\left \{ \mathbf{v}\in L^2(\Omega)^d\quad\texttt{t.c}\quad\Nabla\mathbf{v}\in L^2(\Omega)^{d\times d} \right \}$$
$$Q=L^2_0(\Omega)=\left \{q\in L^2(\Omega)\tc\int_{\Omega}q=0 \right \}$$ 
$$S=\left \{\mathbf{X}\in H^1(\mathcal{B})^d\cap W^{1,\infty}\tc\vert\mathbb{F}\vert =\vert\Nabla_{\mathbf{s}}\mathbf{X}\vert>0,\mathbf{X}(\mathcal{B})\subseteq\Omega \right \}$$
gli spazi delle funzioni test. Introduciamo ora il problema in forma debole
\begin{problem}
Dati $\mathbf{u}_0\in V$, $\mathbf{X}_0\in S$ trovare $(\mathbf{u}(t),p(t),\mathbf{X}(t))\in V\times Q\times S$ tali che
$$\rho\frac{d}{dt}\ps{\mathbf{u}(t)}{\mathbf{v}}+a\ps{\mathbf{u}(t)}{\mathbf{v}}+c({\mathbf{u}(t)},{\mathbf{u}(t)},{\mathbf{v}})+b(p(t),\mathbf{v})=\ps{\mathbf{f}(t)}{\mathbf{v}}$$
$$b(\mathbf{u}(t),q)=0$$
$$\ps{\mathbf{f}(t)}{\mathbf{v}}=-\int_{\mathcal{B}}\mathbb{P}(\mathbf{s},t)\boldsymbol{:}\Nabla_{\mathbf{s}}\mathbf{v}(\mathbf{X}(\mathbf{s},t))\, d\mathbf{s}$$
$$\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x})$$
$$\frac{\partial\mathbf{X}}{\partial t}(\mathbf{s},t)=\mathbf{u}(\mathbf{X}(\mathbf{s},t),t)$$
$$\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(\mathbf{s})$$
\end{problem}
dove $(\cdot\,,\cdot)$ rappresenta il prodotto scalare tra i due termini,
$$a(\mathbf{u},\mathbf{v})= \int_\Omega\eta\Nabla\mathbf{u}\Nabla\mathbf{v}\, d\mathbf{x}$$
$$b(\mathbf{u},p)=\int_\Omega p\Nabla\cdot\mathbf{u}\, d\mathbf{x}$$ e 
$$c(\mathbf{u},\mathbf{v},\mathbf{w})=\int_\Omega\rho(\mathbf{w}\cdot\Nabla\mathbf{u})\mathbf{v}\, d\mathbf{x}$$.

Un ulteriore vantaggio della formulazione variazionale è la possibilità di evitare la distinzione tra le forze $\mathbf{G}$ e $\mathbf{T}$.

\paragraph{Formulazione interamente variazionale}
Nel problema precedente l'evoluzione del corpo è ancora trattata in forma forte. \'E possibile trattare in forma variazionale anche l'equazione [] facendo diventare il problema [] il seguente
\begin{problem}
Dati $\mathbf{u}_0\in V$, $\mathbf{X}_0\in S$ trovare $(\mathbf{u}(t),p(t),\mathbf{X}(t))\in V\times Q\times S$ tali che
$$\rho\frac{d}{dt}\ps{\mathbf{u}(t)}{\mathbf{v}}+a\ps{\mathbf{u}(t)}{\mathbf{v}}+c({\mathbf{u}(t)},{\mathbf{u}(t)},{\mathbf{v}})+b(p(t),\mathbf{v})=\ps{\mathbf{f}(t)}{\mathbf{v}}$$
$$b(\mathbf{u}(t),q)=0$$
$$\ps{\mathbf{f}(t)}{\mathbf{v}}=-\int_{\mathcal{B}}\mathbb{P}(\mathbf{s},t)\boldsymbol{:}\Nabla_{\mathbf{s}}\mathbf{v}(\mathbf{X}(\mathbf{s},t))\, d\mathbf{s}$$
$$\mathbf{u}(\mathbf{x},0)=\mathbf{u}_0(\mathbf{x})$$
$$\frac{d}{dt}((\mathbf{X}(t),\mathbf{Y}))-((\mathbf{u}(\mathbf{X}(t),\mathbf{Y}))=0$$
$$\mathbf{X}(\mathbf{s},0)=\mathbf{X}_0(\mathbf{s})$$
\end{problem}
dove $(( , ))$ rapprensenta l'opportuno prodotto scalare.

Introduciamo l'operatore di interpolazione tra lo spazio euleriano e lagrangiano $\mathbf{S}(\mathbf{X})$ definito come
$$\mathbf{S}(\mathbf{X})\mathbf{Y}(\mathbf{v}) = \ps{\mathbf{Y}}{\mathbf{S}^T(\mathbf{X})\mathbf{v}} = \int_\mathcal{B}\mathbf{Y}\cdot\mathbf{v}(\mathbf{X})\, d\mathbf{s}$$.
Osserviamo che a seconda della codimensione della struttura elastica l'operatore $\mathbf{S}(\mathbf{X})$ è ben definito tra spazi differenti, in particolare se $m=d$ allora 
\begin{equation}
\mathbf{S}(\mathbf{X}):(H^1(\mathcal{B})^d)'\mapsto H^{-1}(\Omega)^d
\end{equation}
\begin{equation}
\mathbf{S}^T(\mathbf{X}):H^1_0(\Omega)^d\mapsto H^{1}(\mathcal{B})^d
\end{equation}
Nel caso $m=d-1$, se si ipotizza di non poter chiedere che $\mathbf{Y}$ possa essere più regolare di $(H^1(\mathcal{B})^d)'$, allora è necessario che la traccia di $\mathbf{u}$ e $\mathbf{v}$ siano almeno in $H^1(\mathcal{B})^d$ e quindi che $\mathbf{u},\mathbf{v}\in H^{3/2+\epsilon}(\Omega)^d$ con $\epsilon>0$.
L'operatore $\mathbf{S}(\mathbf{X})$ sarà definito tra i seguenti spazi
\begin{equation}
\mathbf{S}(\mathbf{X}):(H^1(\mathcal{B})^d)'\mapsto H^{-\frac{3}{2}-\epsilon}(\Omega)^d
\end{equation}
\begin{equation}
\mathbf{S}^T(\mathbf{X}):H^{\frac{3}{2}+\epsilon}_0(\Omega)^d\mapsto H^{1}(\mathcal{B})^d
\end{equation}
La forza elasitica diventa
\begin{equation}
\ps{\mathbf{f}(t)}{\mathbf{v}}[H^{-1}][H^1_0] = \ps{\mathbf{S}(\mathbf{X})\mathbf{D}^T\mathbb{P}(\mathbf{X})}{\mathbf{v}}[H^1_0]=\ps{\mathbf{D}^T\mathbb{P}(\mathbf{X})}{\mathbf{S}^T(\mathbf{X})\mathbf{v}}
\end{equation}
e l'equazione [] può essere scritta come
\begin{equation}
\mathbf{M}\left (\frac{\partial\mathbf{X}}{\partial t}-\mathbf{S}^T(\mathbf{X})\mathbf{u}\right )=0
\end{equation}
e il problema può essere riscritto negli spazi duali come
\begin{problem}
$$M\frac{\partial\mathbf{u}}{\partial t}+A\mathbf{u}+N(\mathbf{u})\mathbf{u}+B^{T}p+\mathbf{S}(\mathbf{X})\mathbf{D}^{T}\mathbb{P}(\mathbf{X})=0 \qquad \text{in\quad}\mathbf{V}'$$
$$B\mathbf{u}=0 \qquad \text{in\quad}Q'=Q$$
$$M(\frac{\partial \mathbf{X}}{\partial t}-\mathbf{S}^{T}(\mathbf{X})\mathbf{u}) \qquad \text{in\quad}(H^{1}(\mathcal{B})^{d})'$$
$$\mathbf{u}(\mathbf{x},0)=\mathbf{u}_{0}(\mathbf{x}) \qquad \forall\mathbf{x}\in\Omega$$
$$\mathbf{X}(\mathbf{s},0)=\mathbf{X}_{0}(\mathbf{s}) \qquad \forall\mathbf{s}\in\mathcal{B}$$
\end{problem}

\subsection{Stima dell'energia}
\begin{lemma}
Per $t \in (0,T)$, sia $\mathbf{u}(t)\in H^1_0(\Omega)^d$, $p(t)\in L^2_0(\Omega)$ e $\mathbf{X}(t)\in H^1_0(\mathcal{B})^m [?]$ la soluzione del problema [] allora $$\frac{1}{2}\frac{d}{dt}\Vert\mathbf{u}(t)\Vert^2_{0,\Omega}+\eta\Vert\Nabla\mathbf{u}(t)\Vert^2_{0,\Omega}+\frac{d}{dt}E[\mathbf{X}(t)]=0$$
dove 
$$E[\mathbf{X}(t)]=\int_\mathcal{B}W\left (\frac{\partial \mathbf{X}(t)}{\partial \mathbf{s}}\right )\, d\mathbf{s}$$
\end{lemma}
[Dimostrazione.]
Il lemma prova che l'energia totale del sistema fluido-struttura, data dalla somma di energia cinetica e potenziale, è limitata dall'energia totale iniziale e che la differenza di energia tra due tempi qualsiasi è data dall'energia dissipata in conseguenza della viscostità.

\subsection{Risultati vari}
Il problema dell'esistenza e dell'unicità delle soluzioni delle equazioni di Navier-Stokes per i fluidi, delle equazioni dei materiali viscoelastici e delle equazioni combinate per le interazioni fluido-struttura [in dimensione 3, magari anche 2] è ancora aperto. Qui viene riportata la dimostrazione fornita in  [] per un problema modello del metodo IB in dimensione 1 mediante iterazioni di punto fisso. [...]

\'E possibile determinare una stima a priori per il limite superiore della norma di $\mathbf{u}$ e $\mathbf{X}$. La dimostrazione è semplice in codimensione zero, mentre è necessario più lavoro per il caso in codimensione uno.

\begin{theorem}
Sia 
\begin{equation}
0<\gamma\leq\vert\mathbb{F}\vert=\vert\Nabla\mathbf{s}\mathbf{X}\vert\quad\forall\mathbf{s}\in\mathcal{B},\forall\mathbf{X}\in S
\end{equation}
e 
\begin{equation}
\mathbb{P}=\mu\mathbb{F}
\end{equation}
 con $\mu>0$ allora le soluzione dei problemi [] soddisfano
$$\Vert\mathbf{u}\Vert^2_{C^0([0,T];L^2(\Omega)^d)}\leq C_0\mathcal{E}_0$$
$$\Vert\mathbf{X}\Vert^2_{C^0([0,T];H^1(\Omega)^d)}\leq C_1\mathcal{E}_0$$
con
$$\mathcal{E}_0=\rho\frac{1}{2}\Vert\mathbf{u}_0\Vert^2_{0,\Omega}+\mu\frac{1}{2}\Vert\Nabla_\mathbf{s}\mathbf{X}_0\Vert^2_{0,\mathcal{B}}$$
\end{theorem}
La prima condizione impone un limite a quanto è possibile comprimere la struttura elastica. In codimensione zero, essendo la struttura incomprimible, vale $|\mathbb{F}|\equiv1$. In codimensione zero, nonostante l'incomprimibilita, $\mathbb{F}$ pur essendo sempre maggiore di zero può diventare nel corso del moto arbitrariamente piccolo.
[... heltai 2.4.1]

\paragraph{Esistenza e unicità}
Una delle principali difficoltà nello studio del metodo IB si trova nel legame tra il moto del corpo e del fluido attraverso l'equazione 
$$\mathbf{u}(\mathbf{X})=\frac{\partial\mathbf{X}}{\partial t}$$
in cui sia $\mathbf{u}$ che $\mathbf{X}$ sono incognite e non c'è modo di linearizzare la loro relazione se non assumendo che la deformazione del corpo sia piccola.

[]

Siano $$V_0=\{\mathbf{v}\in V\tc\Nabla\cdot\mathbf{v}=0 \}$$ il sottospazio di $V$ delle funzioni a divergenza nulla e $$S_0=\{\mathbf{Y}\in S\tc\vert\Nabla_{\mathbf{s}}\mathbf{Y}\vert=1$$ il sottospazio delle deformazioni che conservano il volume. Siano inoltre
$$L(\mathbf{u}):H^1_0(\Omega)^d\mapsto H^{-1}(\Omega)^d$$
$$L(\mathbf{u})\mathbf{u}=A\mathbf{u}+N(\mathbf{u})\mathbf{u}$$
l'operatore di Navier-Stokes e 
$$T:A\times]0,T[\mapsto A$$
$$T(A)=\int^t_0A(\tilde{t})\, d\tilde{t}$$
allora le equazioni del metodo IB possono essere riscritte come
$$M\mathbf{u}+TL(\mathbf{u})\mathbf{u}+T\mathbf{S}(\mathbf{X})\mathbf{D}^T\mathbb{P}(\mathbf{X})=M\mathbf{u}_0$$
$$\mathbf{M}\mathbf{X}-T\mathbf{M}\mathbf{S}^T(\mathbf{X})\mathbf{u}=\mathbf{M}\mathbf{X}_0$$
Per semplificare le difficoltà causate dall'operatore non-lineare  $\mathbf{S}(\mathbf{X})$ introduciamo l'operatore $\text{IB}:S\times[0,T[\mapsto[0,T[$ in modo che $\mathbf{X}=\text{IB}(\mathbf{Y})$ sia la soluzione di
$$M\mathbf{u}+TL(\mathbf{u})\mathbf{u}+T\mathbf{S}(\mathbf{Y})\mathbf{D}^T\mathbb{P}(\mathbf{X})=M\mathbf{u}_0$$
$$\mathbf{M}\mathbf{X}-T\mathbf{M}\mathbf{S}^T(\mathbf{Y})\mathbf{u}=\mathbf{M}\mathbf{X}_0$$
 [soluzione a tempi discreti]
 [ci sono vari problemi su dove sta Y, è meglio prendere passi temporali piccoli]
Cerchiamo ora un sottoinsieme convesso di $S$ in cui cercare un punto fisso dell'operatore $\text{IB}$. Sia 
$$B=\{ \mathbf{Y}\in S\times[0,T[\tc\mathbf{Y}(0)=\mathbf{X}_0\in S_0,\Vert\mathbf{Y}\Vert^2_{C^0(]0,T[,H^1(\mathcal{B})^d)}\leq C_1\mathcal{E}_0\}$$
\begin{theorem}
Dati $\mathbf{u}_0\in V_0$ e $\mathbf{X}_0$ e ipotizzando che
$$\forall\mathbf{Y}\in\mathbf{B}\exists\mathbf{X}=\text{IB}(\mathbf{Y})\in S$$
$$\mathbb{P}=\mu\mathbb{F}, \mu>0$$
allora $\mathbf{X}\in\mathbf{B}$ e esiste un punto fisso $\overline{\mathbf{X}}=\text{IB}(\overline{\mathbf{X}})$ in $C^0()$.
\end{theorem}
\begin{proof}
Sia $\mathbf{X}^{k}(\mathbf{s},t)$ il $k$-esimo termine ottenuto mediante l'iterazione e cerchiamo di determinare il $k+1$-esimo termine risolvendo
$$M\mathbf{u}^{k+1}+TL(\mathbf{u}^{k+1})\mathbf{u}^{k+1}+T\mathbf{S}(\mathbf{X}^{k})\mathbf{D}^{T}\mathbb{P}(\mathbf{X}^{k+1})=M\mathbf{u}_{0}\qquad\text{in}\quad\mathbf{V }'$$
$$M\mathbf{X}^{k+1}-T\mathbf{S}^{T}(\mathbf{X}^{k})\mathbf{u}^{k+1} = M\mathbf{X}_0\qquad\text{in}\quad (H^{1}(\mathcal{B})^{d})'$$
\end{proof}
\paragraph{Il problema in codimensione 1}

%The finite element immersed boundary method, Heltai, Chapter 3 87-110
\chapter{Approssimazione Numerica}

La principale caratteristica del metodo \IB è l'utilizzo della funzione $\delta$ di Dirac non solo come una maniera formale per scrivere le equazioni dell'interazione tra fluido e struttura ma anche come un vero e proprio metodo numerico per collegare gli aspetti descritti con un formalismo euleriano a quelli descritti con un formalismo lagrangiano e viceversa. Nel metodo originale questo viene fatto mediante opportune approssimazioni della funzione $\delta$, che deve avere determinate caratteristiche per garantire la convergenza e la miglior velocità di convergenza allo schema numerico.

Sfruttando la formulazione debole del problema è possibile evitare di approssimare la funzione $\delta$ mantenendo i vantaggi del metodo \IB, potendo sfruttare il metodo degli elementi finiti e migliorando così l'accuratezza della soluzione numerica.

[problema non interamente variazionale: l'evoluzione della mesh lagrangiana è calcolata punto per punto usando la velocità del fluido
problema interamente variazionale: posso sfruttare elemfiniti anche per l'evoluzione della mesh]

\section{Metodo FE-IB}
Sia $\mathcal{T}_h$ una mesh costruita su $\Omega$ formata da triangoli o quadrilateri nel caso $d=2$, o da tetraedri o esaedri nel caso $d=3$. Siano $V_h \subseteq H^1_0(\Omega)^d$ e $Q_h \subseteq L^2_0(\Omega)$ due sottospazi a dimensione finita degli spazi delle funzioni test $V$ e $Q$ che soddisfano la condizione inf-sup per garantire l'esistenza, unicità e la stabilità del problema di Navier-Stokes discreto. [Si può scegliere ad esempio la coppia Q2-P1.]

Sia $\mathcal{U}_h$ una mesh di $\mathcal{B}$ formata da segmenti, triangoli o tetraedri. Sia $S_h$ un sottospazio a dimensione finita dello spazio $S$. [Ad esempio è possibile scegliere lo spazio delle funzioni lineari a tratti.]

Scriviamo ora la versione spazialmente discreta del problema.

Se $\mathbf{X}_h$ è lineare a tratti allora 
$$\ps{\mathbf{f}_h(t)}{\mathbf{v}}=-\int_{\mathcal{B}}\mathbb{P}_{\alpha,\beta}(\mathbf{X}_h)\frac{\partial}{\partial s_\beta}(v_\alpha(\mathbf{X}_h))\, d\mathbf{s}$$
Scriviamo l'integrale come somma sugli elementi della mesh, tenendo conto che $X_h$ è lineare a tratti e che la sua derivata e $\mathcal{P}$ sono costanti a tratti.
$$\ps{\mathbf{f}_h(t)}{\mathbf{v}}=-\sum^M_{k=1}\int_{T_k}\mathbb{P}_{\alpha,\beta}(\mathbf{X}_h)\frac{\partial}{\partial s_\beta}(v_\alpha(\mathbf{X}_h))\, d\mathbf{s}
    =-\sum^M_{k=1}\int_{\partial T_k}\mathbb{P}_{\alpha,\beta}(\mathbf{X}_h)N_i v_\alpha(\mathbf{X}_h)\, dA$$
I vari contributi dovuti a lati comuni degli elementi si annullano e rimangono solo quelli riguardanti il bordo della struttura $\mathcal{B}$
$$\ps{\mathbf{f}_h(t)}{\mathbf{v}}=-\sum_{e\in\mathcal{E}}\int_e\mathbb{P}_h\mathbf{N}\cdot\mathbf{v}(\mathbf{X}_h)\,dA$$
Con questa espressione del termine sorgente il problema diventa
\begin{problem}
\end{problem}
Per garantire una migliore stabilità al problema l'operatore $c(\mathbf{u},\mathbf{v},\mathbf{w})$ è sostituito da
$$c_h(\mathbf{u},\mathbf{v},\mathbf{w})=\frac{\rho}{2}(\ps{\mathbf{u}\cdot\Nabla\mathbf{v}}{\mathbf{w}}-\ps{\mathbf{u}\cdot\Nabla\mathbf{w}}{\mathbf{v}})$$
Si può osservare che se $\Nabla\cdot\mathbf{u}=0$ allora $c(\mathbf{u},\mathbf{v},\mathbf{w})=c_h(\mathbf{u},\mathbf{v},\mathbf{w})$ e inoltre $c_h(\mathbf{u},\mathbf{v},\mathbf{v})=0$.
[caso $m=1$ e $d=2$]

\section{Approssimazione temporale}

Per quanto riguarda la discretizzazione temporale verrà usato il metodo delle differenze finite. Questi metodi si dividono in due categorie principali: i metodi espliciti, più convenienti in termini computazionali ma che soffrono di problemi di stabilità e i metodi impliciti, più dispendiosi in termini di tempo di calcolo, soprattutto se applicati a problemi non lineari, ma più stabili [].

Il primo metodo presentato è uno schema totalmente implicito, implementato utilizzando il metodo di Eulero implicito sia per le equazioni del fluido che della struttura e in seguito chiamato BE/BE. Essendo le equazioni che governano il fluido e che regolano l'interazione tra questo e la struttura elastica non lineari questo metodo richiede ad ogni passo temporale di utilizzare un metodo numerico iterativo per risolvere l'equazione non lineare.

Alternativamente è possibile usare una variante semi-implicita, in seguito FE/BE, in cui i termini non lineari vengono discretizzati usando il metodo di Eulero esplicito. Non essendo questa variante incondizionatamente stabile è necessario soddisfare una opportuna condizione CFL per garantirne la stabiltà.

Sia $\Delta t$ il passo temporale usato, $T$ il tempo finale, $N=\frac{T}{\Delta t}$ il numero di passi necessari per raggiungere $T$ e indicato con $f^n = f(t_n) = f(n\Delta t)$ il valore della variabile $f$ al tempo $t_n=n\Delta t$. [56]

\subsection{BE/BE}

\begin{problem}
Dati $\mathbf{u}_0\in\mathbf{V}_h$ e  $\mathbf{X}_0\in\mathcal{S}_h$ per ogni $n\in\{0,...,N-1\}$ trovare la soluzione di
\begin{equation}
\begin{aligned}
&\rho(\frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Delta t}, \mathbf{v}) + c_h(\mathbf{u}^{n+1},\mathbf{u}^{n+1},\mathbf{v}) + a(\mathbf{u}^{n+1},\mathbf{v}) + b(\mathbf{v},p^{n+1}) = \ps{\mathbf{f}^{n+1}}{\mathbf{v}} \quad \forall\mathbf{v}\in\mathbf{V}_h\\
&b(\mathbf{u}^{n+1},q)=0 \quad \forall q\in Q_h\\
&\frac{\mathbf{X}^{n+1}-\mathbf{X}^{n}}{\Delta t} = \mathbf{u}^{n+1}(\mathbf{X}^{n+1})\\
&\ps{\mathbf{f}^{n+1}}{\mathbf{v}}=-\sum_{e\in\mathcal{E}}\int_e\mathbb{P}_h(\mathbf{X}_h^{n+1})\mathbf{N}\cdot\mathbf{v}(\mathbf{X}^{n+1}_h)\,dA\\
\end{aligned}
\end{equation}
\end{problem}


\subsection{FE/BE}
\begin{problem}
Dati $\mathbf{u}_0\in\mathbf{V}_h$ e  $\mathbf{X}_0\in\mathcal{S}_h$ per ogni $n\in\{0,...,N-1\}$ trovare la soluzione di
\begin{equation}
\begin{aligned}
&\rho(\frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Delta t}, \mathbf{v}) + c_h(\mathbf{u}^{1},\mathbf{u}^{n+1},\mathbf{v}) + a(\mathbf{u}^{n+1},\mathbf{v}) + b(\mathbf{v},p^{n+1}) = \ps{\mathbf{f}^{n}}{\mathbf{v}} \quad \forall\mathbf{v}\in\mathbf{V}_h\\
&b(\mathbf{u}^{n+1},q)=0 \quad \forall q\in Q_h\\
&\frac{\mathbf{X}^{n+1}-\mathbf{X}^{n}}{\Delta t} = \mathbf{u}^{n+1}(\mathbf{X}^{n})\\
&\ps{\mathbf{f}^{n}}{\mathbf{v}}=-\sum_{e\in\mathcal{E}}\int_e\mathbb{P}_h(\mathbf{X}_h^{n})\mathbf{N}\cdot\mathbf{v}(\mathbf{X}^{n}_h)\,dA\\
\end{aligned}
\end{equation}
\end{problem}

\section{Analisi della stabilità}

[instabilità dovuta al fluido, instabilità dovuta alla struttura]

L'analisi della stabilità verrà fatta sfruttando la stima dell'energia []

\subsection{Stabilità del problema spazialmente discreto}

\begin{theorem}
Per $t\in]0,T[$, siano $\mathbf{u}_h(t)\in\mathbf{V}_h$, $p_h(t)\in Q_h$ e $\mathbf{X}_h(t)\in\mathbf{S}_h$ le soluzioni del problema [] allora
$$\frac{1}{2}\frac{d}{dt}\Vert\mathbf{u}_h(t)\Vert^2_{0,\Omega}+\eta\Vert\Nabla\mathbf{u}_h(t)\Vert^2_{0,\Omega}+\frac{d}{dt}E_p[\mathbf{X}_h(t)]=0$$
\end{theorem}
\begin{proof}
Preso $\mathbf{v}=\mathbf{u}_h(t)$ e osservato che $c_h(\mathbf{u}_h(t),\mathbf{u}_h(t),\mathbf{u}_h(t))=0$ allora
$$\frac{1}{2}\frac{d}{dt}\Vert\mathbf{u}_h(t)\Vert^2_{0,\Omega}+\eta\Vert\Nabla\mathbf{u}_h(t)\Vert^2_{0,\Omega} = -\int_{\mathcal{B}}\mathbb{P}(\mathbb{F}_h(t))\frac{\partial}{\partial t}(\mathbf{u}_h(\mathbf{X}_h(t)))\,d\mathbf{s}$$
$$=-\int_{\mathcal{B}}\frac{\partial W(\mathbb{F}_h(t))}{\partial \mathbb{F}}\frac{\partial}{\partial \mathbf{s}}\frac{\partial\mathbf{X}_h(t)}{\partial t}\,d\mathbf{s}=-\frac{d}{dt}\int_{\mathcal{B}}W(\mathbb{F}_h(t))\,d\mathbf{s}$$
usando [].
\end{proof}

\subsection{Stabilità del problema spazialmente e temporalmente discreto}

Per poter fare previsioni sulla stabilità del problema è necessario richiedere che
$${k}_\text{min}\mathbb{E}^2\leq\mathbb{E}\mathbf{:}\mathbb{H}\mathbf{:}\mathbb{E}\leq{k}_\text{max}\mathbb{E}^2$$
con
$$\mathbb{H}_{\alpha i\beta j}=\frac{\partial^2 W}{\partial\mathbb{F}_{\alpha i}\partial\mathbb{F}_{\beta j}}$$

Questa condizione è soddisfatta dal metodo IB per materiali neo-Hookiani [${k}_\text{max}={k}_\text{min}>0$] o per piccole deformazioni[elasticità linearizzata?], mentre non lo è nel caso generale per grandi deformazioni.

L'approssimazione temporale ha l'effetto di introdurre una viscosità artificiale $\eta_a$ nella stima dell'energia. Se $\eta_a$ è positiva allora il metodo è incondizionatamente stabile, nel caso in cui sia negativa e la somma $\eta+\eta_a$ sia anch'essa negativa ha l'effetto di creare energia ad ogni step temporale rendendo il metodo instabile. Sarà necessario richiedere quindi che $\eta+\eta_a>0$.

\begin{theorem}
Siano $\mathbf{u}_h$, $\mathbf{X}_h$ le soluzioni del problema. Se la densità di energia $W$ è una funzione $C^2$ dei suoi argomenti e la mesh Lagrangiana è quasi-uniforme allora
$$\frac{1}{2\Delta t}(\Vert\mathbf{u}^{n+1}_h\Vert^2_{0,\Omega}-\Vert\mathbf{u}^{n}_h\Vert^2_{0,\Omega})+(\eta+\eta_a)\Vert\Nabla\mathbf{u}^{n+1}_h\Vert^2_{0,\Omega}+\frac{1}{\Delta t}(\int_{\mathcal{B}}W(\mathbb{F}^{n+1}_h(t))\,d\mathbf{s}-\mathcal{B}W(\mathbb{F}^{n}_h(t))\,d\mathbf{s})\leq 0$$
Nel caso BE/BE
$$\eta_a=k_\text{min}C\frac{h_s^{(m-2)}\Delta t}{h_x^{(d-1)}}L^{n+1}C_e^{n+1}$$
Nel caso FE/BE
$$\eta_a=-k_\text{max}C\frac{h_s^{(m-2)}\Delta t}{h_x^{(d-1)}}L^nC_e^n$$
con $$L^n=\max_{T_k\in S_h} \{ \max_{\mathbf{s}_i,\mathbf{s}_j\in V(T_k)} \vert \mathbf{X}^n_h(\mathbf{s}_j) - \mathbf{X}^n_h(\mathbf{s}_i) \vert \}$$
e $C_e^n$ il massimo numero di elementi lagrangiani che toccano lo stesso elemento euleriano.
\end{theorem}
\begin{proof}
\end{proof}

\section{Il metodo FE-IB con moltiplicatori di Lagrange distribuiti}
[]
Nel problema la relazione tra le velocità  del fluido e della struttura è data dall'equazione
$$\mathbf{u}(\mathbf{X}(\mathbf{s},t),t)=\frac{\partial \mathbf{X}}{\partial t}(\mathbf{s},t)$$
Questa può dare alcuni problemi [].

L'equazione può essere scritta in forma variazionale [].

Siano $\Lambda$, $H_1$ e $H_2$ tre spazi funzionali e $c_1:\Lambda\times H_1\mapsto\Re$, $c_2:\Lambda\times H_2\mapsto\Re$ tali che
$$\forall\mathbf{v}\in H_1,\mathbf{Y}\in H_2\tc\exists\mathbf{X'} c_1(\lambda,\mathbf{v}(\mathbf{X'}))-c_2(\lambda,\mathbf{Y})=0 \quad\forall\lambda\in\Lambda$$
allora $$\mathbf{v}(\mathbf{X'})=\mathbf{Y}$$.
Sostituiamo all'equazione
$$c_1(\lambda,\mathbf{u}(\mathbf{X}(\cdot,t),t))-c_2(\lambda,\frac{\partial\mathbf{X}}{\partial t}(t))=0$$
Questa nuova equazione può essere intesa come una restrizione al nostro sistema e possiamo introdurre il moltiplicatore di Lagrange associato nella prima equazione e riscrivere il problema.

[]

Possiamo ora introdurre la versione discreta del problema [] usando gli elementi finiti

e poi la discretizzazione temporale del problema.

\subsection{Analisi della stabilità }


\subsection{Conservazione della massa}

\paragraph{Conservazione locale della massa per il problema di Stokes}
%Local Mass Conservation of Stokes Finite Element
Nella formulazione variazionale del problema il vincolo dell'incomprimibilità è imposto solo debolmente e quindi non sarà soddisfatto puntualmente a meno che [].

Verranno presentate alcune modifiche agli elementi di Hood-Taylor e Bercovier-Pironneau in modo da ammettere pressioni discontinue cosicché il vincolo dell'incomprimilità possa essere soddisfato almeno in media elemento per elemento. Verrà quindi verificata la condizione inf-sup e la stabilità dello schema numerico.

\subparagraph{Il problema di Stokes}
Si consideri il problema di Stokes
$$-\Delta\mathbf{u}-\nabla p=\mathbf{f}\quad\text{in}\Omega$$
$$\Nabla\cdot\mathbf{u}=0\quad\text{in}\Omega$$
$$\mathbf{u}=0\quad\text{su}\partial\Omega$$
dove $\mathbf{u}$ è la velocità del fluido, $p$ è la pressione, $\mathbf{f}$ è la forza esterna e $\Omega\subset\Re^d$ ($d=2,3$) è un dominio poligonale o poliedrale.

Siano $\mathbf{V}=H^1_0(\Omega)^d$ e $Q=L^2_0(\Omega)$ allora il problema in forma debole diventa
$$a(\mathbf{u},\mathbf{v})+b(\mathbf{v},p)=(\mathbf{f},\mathbf{v})\quad\forall\mathbf{v}\in\mathbf{V}$$
$$b(\mathbf{u},q)=0\quad\forall q\in Q$$
dove $(\cdot,\cdot)$ è il prodotto scalare in $L^2$ e
$$a(\mathbf{u},\mathbf{v})=\int_{\Omega}\Nabla\mathbf{u}\boldsymbol{:}\Nabla\mathbf{v}\,d\mathbf{x}$$
$$b(\mathbf{u},p)=-\int_{\Omega}p\Nabla\cdot\mathbf{u}\,d\mathbf{x}$$

Sia $\mathcal{T}_h$ una mesh costituita da simplessi costruita su $\Omega$ che soddisfa [shape-regular?], dove $h$ è il maggiore dei diametri degli elementi di $\mathcal{T}_h$.

Siano $\mathbf{V}_h\subset\mathbf{V}$ e $Q_h\subset Q$ due sottospazi di dimensione finita. Il problema discreto diventa
$$a(\mathbf{u}_h,\mathbf{v}_h)+b(\mathbf{v}_h,p_h)=(\mathbf{f},\mathbf{v}_h)\quad\forall\mathbf{v}_h\in\mathbf{V}_h$$
$$b(\mathbf{u}_h,q_h)=0\quad\forall q_h\in Q_h$$
Se $a(\cdot,\cdot)$ è coerciva su $\mathbf{V}$ allora per garantire l'esistenza, l'unicità e la stabilità della soluzione discreta del problema di Stokes è sufficiente che gli spazi $(\mathbf{V}_h,Q_h)$ soddisfino la condizione inf-sup
$$\exists\beta>0\quad\text{indipendente da $h$ tale che}$$
$$\inf_{q_h\in Q_h}\sup_{\mathbf{v}_h\in\mathbf{V}_h}\frac{b(\mathbf{v}_h,q_h)}{\Vert\mathbf{v}_h\Vert_{\mathbf{V}}\Vert q_h\Vert_{Q}}\geq\beta$$
Infatti se la soddisfano allora vale
$$\Vert\mathbf{u}-\mathbf{u}_h\Vert_{\mathbf{V}}+\Vert p - p_h \Vert_{Q}\leq C\inf_{\mathbf{v}_h\in\mathbf{V}_h,q_h\in Q_h}(\Vert\mathbf{u}-\mathbf{v}_h\Vert_{\mathbf{V}}+\Vert p - q_h \Vert_{Q})$$

La condizione inf-sup può essere verificata con il metodo dei macroelementi. []

Teorema dei macroelementi.

\subparagraph{Analisi della stabilità}

Elemento di Hood-Taylor modificato.

$$\mathbf{V}_h=\{\mathbf{v}\in H^1_0(\Omega)^d\tc\mathbf{v}_{\vert K}\in P_{k+1}(K)^d\forall K\in\mathcal{T}_h \}$$
$$Q_h=\{ q\in L^2_0(\Omega)^d\tc q=q_k+q_0. q_k\in C(\bar{\Omega}),{q_k}_{\vert K}\in P_k(K), {q_0}_{\vert K}\in P_0(K)\forall K\in\mathcal{T}_h \}$$
Per soddisfare l'ipotesi H5 è necessario scegliere $k\geq d-1$.

Dimostriamo ora l'ipotesi H1 sfuttando una generalizzazione dell'argomento usato per l'elemento di Hood-Taylor

Proposizione. Si ipotizzi che ogni elemento $ K\in\mathcal{T}_h$ abbia almeno un vertice nell'interno di $\Omega$. Sia $\mathcal{M}_h$ l'insieme dei macroelementi ottenuti raggruppando quegli elementi che per ogni vertice interno $x_0$ toccano $x_0$. Allora per ogni $M\in\mathcal{M}_h$ lo [spazio nullo?nucleo?] $N_M$ è monodimensionale ed è formato da funzioni costanti su $M$.
Dimostrazione. []

Elemento di Bercovier-Pironneau modificato.

$$\mathbf{V}_h=\{\mathbf{v}\in H^1_0(\Omega)^2\tc\mathbf{v}_{\vert K}\in P_{1}(K)^2\forall K\in\mathcal{T}_{h/2} \}$$
$$Q_h=\{ q\in L^2_0(\Omega)^d\tc q=q_1+q_0. q_k\in C(\bar{\Omega}),{q_1}_{\vert K}\in P_1(K), {q_0}_{\vert K}\in P_0(K)\forall K\in\mathcal{T}_{h/2} \}$$
con $\mathcal{T}_{h/2}$ ottenuto []. 

Proposizione. Si ipotizzi che ogni elemento $ K\in\mathcal{T}_h$ abbia almeno un vertice nell'interno di $\Omega$. Sia $\mathcal{M}_h$ l'insieme dei macroelementi ottenuti raggruppando quegli elementi che per ogni vertice interno $x_0$ toccano $x_0$. Allora per ogni $M\in\mathcal{M}_h$ lo [spazio nullo?nucleo?] $N_M$ è monodimensionale ed è formato da funzioni costanti su $M$.
Dimostrazione. []

Teorema. Soddisfano inf-sup.

\paragraph{Conservazione della massa per il metodo DLM-IB-FE}
%Coupled 2013 pg 323 MASS PRESERVING DISTRIBUTED LANGRAGE MULTIPLIER APPROACH TO IMMERSED BOUNDARY METHOD

\chapter{Risulati numerici}
[integrazione]\\

[colliision detection]\\

[sparsità]\\

[decomposizioni, pseudoinversa,...]\\

\end{document}
